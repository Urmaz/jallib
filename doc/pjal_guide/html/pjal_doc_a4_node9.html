<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>5 Variables</TITLE>
<META NAME="description" CONTENT="5 Variables">
<META NAME="keywords" CONTENT="pjal_doc_a4">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="pjal_doc_a4.css">

<LINK REL="next" HREF="pjal_doc_a4_node10.html">
<LINK REL="previous" HREF="pjal_doc_a4_node8.html">
<LINK REL="up" HREF="pjal_doc_a4_node4.html">
<LINK REL="next" HREF="pjal_doc_a4_node10.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html370"
  HREF="pjal_doc_a4_node10.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html366"
  HREF="pjal_doc_a4_node4.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html360"
  HREF="pjal_doc_a4_node8.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html368"
  HREF="pjal_doc_a4_node2.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html371"
  HREF="pjal_doc_a4_node10.html">6 Tables</A>
<B> Up:</B> <A NAME="tex2html367"
  HREF="pjal_doc_a4_node4.html">1 Language definition</A>
<B> Previous:</B> <A NAME="tex2html361"
  HREF="pjal_doc_a4_node8.html">4 Constants</A>
 &nbsp; <B>  <A NAME="tex2html369"
  HREF="pjal_doc_a4_node2.html">Contents</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html372"
  HREF="pjal_doc_a4_node9.html#SECTION00451000000000000000">1 Declaration</A>
<LI><A NAME="tex2html373"
  HREF="pjal_doc_a4_node9.html#SECTION00452000000000000000">2 Location</A>
<LI><A NAME="tex2html374"
  HREF="pjal_doc_a4_node9.html#SECTION00453000000000000000">3 Volatile</A>
<LI><A NAME="tex2html375"
  HREF="pjal_doc_a4_node9.html#SECTION00454000000000000000">4 Alias</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION00450000000000000000">
5 Variables</A>
</H1>

<P>
<A NAME="sub:Variables"></A>
<P>

<H2><A NAME="SECTION00451000000000000000">
1 Declaration</A>
</H2>

<P>
<A NAME="sub:Variable-Declaration"></A>
<P>
A variable declaration introduces a name which will be used within
the <I>JAL 2.0</I> program. In PIC architecture this name will correspond
to a hardware location called <I>register</I> located in RAM memory. 

<P>
These <I>registers</I> can be of two types: 

<P>

<UL>
<LI>GPR. General Purpose Registers
</LI>
<LI>SFR. Special Function Registers
</LI>
</UL>
Optionally the name can be bound to a specific location<A NAME="tex2html9"
  HREF="#foot1597"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A>, or to other already declared variable<A NAME="tex2html10"
  HREF="#foot1598"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A>, otherwise the compiler allocates a suitable and available GPR location. 

<P>
In a declaration a value can be assigned to a variable, which has
the same effect as an equivalent assignment immediately following
the declaration. 

<P>
<B>Example</B>: <PRE>    var byte demo = 0xAF 
   
   --  ... same as ...
   var byte demo
   demo = 0xAF
</PRE>

<P>
The initial value does not need to be a constant expression.

<P>
<I>JAL 2.0</I> will set the correct bank memory while addressing a variable
(except in inline assembler<A NAME="tex2html11"
  HREF="#foot1599"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A>).

<P>
<PRE>    VAR [VOLATILE] type[*cexpr] 
      identifier [ '[' cexpr ']' ]

      [ { AT cexpr [ : bit ] | 
             variable [ : bit ] | 
            '{' cexpr1[, cexpr2...] '}'

      | IS variable }

    [ '=' cexpr | '{' cexpr1, ... '}' | '=' '"' cexpr '"']

    [, identifier2...]
</PRE>

<P>

<BR>
<P>
<DL>
<DT><STRONG>VAR</STRONG></DT>
<DD>denotes the beginning of a variable definition clause.
</DD>
</DL>

<BR>
<P>
<DL>
<DT><STRONG>VOLATILE</STRONG></DT>
<DD>A variable can be declared volatile, which expresses that
the variable does not possess normal variable semantics<A NAME="tex2html12"
  HREF="#foot1600"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A>. 
</DD>
</DL>

<BR>
<P>
<DL>
<DT><STRONG>type[*cexpr]</STRONG></DT>
<DD>The <I>type</I> of the variable<A NAME="tex2html13"
  HREF="#foot1601"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A>. 
</DD>
</DL>

<BR>
<P>
<DL>
<DT><STRONG>Identifier</STRONG></DT>
<DD>Any valid <I>JAL 2.0</I> identifier.
</DD>
</DL>

<BR>
<P>
<DL>
<DT><STRONG>'['&nbsp;cexpr&nbsp;']'</STRONG></DT>
<DD>Defines a table<A NAME="tex2html14"
  HREF="#foot1602"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A> of <I>cexpr</I><A NAME="tex2html15"
  HREF="#foot1603"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A> elements. The table index starts at 0 and continues through (cexpr
- 1). cexpr must be &gt;= 1. A table <I>MUST</I> fit entirely within
a single PIC data bank.
</DD>
</DL>

<BR>
<P>
<DL>
<DT><STRONG>AT&nbsp;...</STRONG></DT>
<DD>denotes the location of the variable<A NAME="tex2html16"
  HREF="#foot1604"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A>. 
</DD>
</DL>

<BR>
<P>
<DL>
<DT><STRONG>IS&nbsp;variable</STRONG></DT>
<DD>Tells the compiler that this identifier is simply an
alias for another<A NAME="tex2html17"
  HREF="#foot1605"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A>. 
</DD>
</DL>

<BR>
<P>
<DL>
<DT><STRONG>'='&nbsp;expr</STRONG></DT>
<DD>Shorthand assignment. The variable will be assigned expr.
</DD>
</DL>

<BR>
<P>
<DL>
<DT><STRONG>'='&nbsp;'{'&nbsp;expr1&nbsp;[,&nbsp;expr2&nbsp;...]&nbsp;'}'</STRONG></DT>
<DD>For a table variable,
the elements will be assigned expr1, expr2, .... 
</DD>
</DL>

<BR>
<P>
<DL>
<DT><STRONG>''''&nbsp;cexpr&nbsp;''''</STRONG></DT>
<DD>A <I>string</I> constant can be assigned to
a variable table: 
<BR><code>var byte x[5] = "hello"</code>.
</DD>
</DL>

<BR>
<P>
<DL>
<DT><STRONG>,&nbsp;identifier2&nbsp;...</STRONG></DT>
<DD>Allows defining multiple variables with
the same attributes: VAR BYTE a,b,c
</DD>
</DL>

<BR>
<P>
<PRE>    var byte x, y=3
   var word z
   var dword i=0
   var byte AD_lo, AD_hi
   var word AD_result = AD_lo + 256*AD_hi
</PRE>

<P>
<BR CLEAR="ALL">
<HR>
<P>

<H2><A NAME="SECTION00452000000000000000">
2 Location</A>
</H2>

<P>
<A NAME="sub:Location"></A>
<P>
A variable declaration can specify the adress of the variable. The
address expression must be compile-time constant. The compiler takes
care of the translation to the banked address. 

<P>
<DL>
<DT><STRONG>AT&nbsp;cexpr&nbsp;[&nbsp;':'&nbsp;bit&nbsp;]</STRONG></DT>
<DD>Places the new variable at address
<I>cexpr</I>. 
</DD>
</DL>

<BR>
<P>
<DL>
<DT><STRONG>AT&nbsp;variable&nbsp;[&nbsp;':'&nbsp;bit&nbsp;]</STRONG></DT>
<DD>Places the new variable at the
same address as an existing variable. Any address uses for explicit
placement will not be allocated to another variable.
</DD>
</DL>

<BR>
<P>
<DL>
<DT><STRONG>AT&nbsp;'{'&nbsp;cexpr1[,&nbsp;cexpr2&nbsp;...]&nbsp;'}'</STRONG></DT>
<DD>Places the new variable
at multiple address. On the PIC, many of the special purpose registers<A NAME="tex2html18"
  HREF="#foot347"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A> are mirrored in two or more data banks. Telling the compiler which
address hold the variable allows it to optimize the data access bits.
</DD>
</DL>

<BR>
<P>
<PRE>   var byte volatile porta at 0x06
   var volatile byte _status AT {0x0003, 0x0083, 
                                 0x0103, 0x0183}
   var bit  volatile _z at _status : 2
</PRE>

<P>
<BR CLEAR="ALL">
<HR>
<P>

<H2><A NAME="SECTION00453000000000000000">
3 Volatile</A>
</H2>

<P>
<A NAME="sub:Volatile"></A>
<P>
The <I>VOLATILE</I> keyword guarantees that a variable that is either
used or assigned will not be optimized away, and the variable will
be only read once when evaluating an expression. Normally, if a variable
is assigned a value that is never used, the assignment is removed
and the variable will not allocated any space.

<P>
If the assignment is an expression, the expression <I>will</I> be
fully evaluated. If a variable is used, but never assigned, all instances
of the variable <I>will</I> be replaced with the constant 0 (of the
appropriate type) and the variable <I>will not</I> be allocated any
space.

<P>
SFR's should always be declared as <I>VOLATILE</I>, as these are associated
with certain hardware functions specific to the PIC being used. 

<P>
<PRE>   var volatile byte FSR at 4 
   var volatile byte INDF at 0
   var volatile byte count
</PRE>

<P>
<BR CLEAR="ALL">
<HR>
<P>

<H2><A NAME="SECTION00454000000000000000">
4 Alias</A>
</H2>

<P>
<A NAME="sub:Alias"></A>
<P>
A variable can be declared to be an alias for another variable. This
is used much like a constant declaration to hide the actual identity
of an identifier from subsequent code.

<P>
<PRE>   -- fragment of a library file,
   -- which defines the pins used by the library
   var byte volatile i2c_clock    is pin_a3
   var byte volatile i2c_data_in  is pin_a4
   var byte volatile i2c_data_out is pin_a4_direction
</PRE>

<P>
<BR><HR><H4>Footnotes</H4>
<DL>
<DT><A NAME="foot1597">... location</A><A
 HREF="pjal_doc_a4_node9.html#tex2html9"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A></DT>
<DD>See section <A HREF="#sub:Location">1.5.2</A>&nbsp;sub:Location

</DD>
<DT><A NAME="foot1598">... variable</A><A
 HREF="pjal_doc_a4_node9.html#tex2html10"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A></DT>
<DD>See section <A HREF="#sub:Alias">1.5.4</A>&nbsp;sub:Alias

</DD>
<DT><A NAME="foot1599">... assembler</A><A
 HREF="pjal_doc_a4_node9.html#tex2html11"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A></DT>
<DD>See section <A HREF="pjal_doc_a4_node15.html#sub:Inline-assembler">1.11</A>&nbsp;sub:Inline-assembler

</DD>
<DT><A NAME="foot1600">... semantics</A><A
 HREF="pjal_doc_a4_node9.html#tex2html12"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A></DT>
<DD>See section <A HREF="#sub:Volatile">1.5.3</A>&nbsp;sub:Volatile

</DD>
<DT><A NAME="foot1601">... variable</A><A
 HREF="pjal_doc_a4_node9.html#tex2html13"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A></DT>
<DD>See section <A HREF="pjal_doc_a4_node6.html#sub:Built-in-types">1.2.1</A>&nbsp;sub:Built-in-types
and section <A HREF="pjal_doc_a4_node6.html#sub:Extending-types-with">1.2.2</A>&nbsp;sub:Extending-types-with.

</DD>
<DT><A NAME="foot1602">... table</A><A
 HREF="pjal_doc_a4_node9.html#tex2html14"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A></DT>
<DD>See section <A HREF="pjal_doc_a4_node10.html#sub:Variable-tables">1.6.2</A>&nbsp;sub:Variable-tables.

</DD>
<DT><A NAME="foot1603">...cexpr</A><A
 HREF="pjal_doc_a4_node9.html#tex2html15"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A></DT>
<DD><I>cexpr</I> means a constant expression or a literal value.

</DD>
<DT><A NAME="foot1604">... variable</A><A
 HREF="pjal_doc_a4_node9.html#tex2html16"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A></DT>
<DD>See section <A HREF="#sub:Location">1.5.2</A>&nbsp;sub:Location

</DD>
<DT><A NAME="foot1605">... another</A><A
 HREF="pjal_doc_a4_node9.html#tex2html17"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A></DT>
<DD>See section <A HREF="#sub:Alias">1.5.4</A>&nbsp;sub:Alias

</DD>
<DT><A NAME="foot347">... registers</A><A
 HREF="pjal_doc_a4_node9.html#tex2html18"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A></DT>
<DD>SFRs in Microchip<SUP><SMALL>TM</SMALL></SUP>'s terminology.

</DD>
</DL><HR>
<!--Navigation Panel-->
<A NAME="tex2html370"
  HREF="pjal_doc_a4_node10.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html366"
  HREF="pjal_doc_a4_node4.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html360"
  HREF="pjal_doc_a4_node8.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html368"
  HREF="pjal_doc_a4_node2.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html371"
  HREF="pjal_doc_a4_node10.html">6 Tables</A>
<B> Up:</B> <A NAME="tex2html367"
  HREF="pjal_doc_a4_node4.html">1 Language definition</A>
<B> Previous:</B> <A NAME="tex2html361"
  HREF="pjal_doc_a4_node8.html">4 Constants</A>
 &nbsp; <B>  <A NAME="tex2html369"
  HREF="pjal_doc_a4_node2.html">Contents</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<HR>pJAL Manual.<BR>(c) 2006 Javier Martinez, Vasile Surducan and Dave Lagzdin.
</ADDRESS>
</BODY>
</HTML>
