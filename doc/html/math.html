<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
    <head>
    		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
		<title>math - jallib API doc</title>
    </head>
    <body>
		
		        <div id="page">
        
            <div id="pagecontent">

			    
	<a href="#toc" name="math">
    <h1>math</h1>
	</a>

    <div>
		<font size="+1"><i>math.jal - Collection of mathematical functions.</i></font>
	</div>

	<br/>

    <div class="narrow">
        
	<table>
	<tr>
		<td style="border: 1px solid #aaa; padding: 5px;">
			<b>Author</b>
		</td>
		<td style="border: 1px solid #aaa; padding: 5px;">
			Rob Hamerling, Michael Watterson Copyright &copy; 2009..2011, all rights reserved.
		</td>
	</tr>
	<tr>
		<td style="border: 1px solid #aaa; padding: 5px;">
			<b>Adapted-by</b>
		</td>
		<td style="border: 1px solid #aaa; padding: 5px;">
			Michael Watterson, Eur van Andel, Rob Hamerling
		</td>
	</tr>
	<tr>
		<td style="border: 1px solid #aaa; padding: 5px;">
			<b>Compiler</b>
		</td>
		<td style="border: 1px solid #aaa; padding: 5px;">
			2.4o
		</td>
	</tr>
	</table>

	<br/>
	
	<b>Description</b>
	<p>
		<pre>Collection of mathematical routines.
</pre>

	</p>
	<br/>

	<b>Sources</b>
	<p>
		<pre>Various authors.
</pre>

	</p>
	<br/>

	<b>Notes</b>
	<p>
		<pre>.
1. This library contains a number of routines handling 'fixed point' numbers.
   These numbers are contained in a signed word or signed double word
   as <value> * 256. In other words the digits behind the decimal point are
   stored in the least significant byte of the signed word or signed double word.
   For example a fixed point value '+18.5' is stored in a 16-bits signed word
   with value 256 * 18.5, which is 4736 decimal or 0x1280 hexadecimal.
   You could also think of '+18' (0x12) being stored in the most significant byte
   and '.5' in the least significant byte (0.5 * 256 = 128, or 0x80).
2. Fixed point math is 8 bits for the decimal part in this library,
   approximately 2 decimal places, the part after the "point" is 0 to 255.
   sword fixed point numbers are thus -127.00 to +127.00 approx.
   When you need bigger numbers replace all swords by sdwords and
   sdwords by sbyte*8, if the compiler can still do the math.
</pre>

	</p>
	<br/>
	
	<b>Dependencies</b>
	<p>
		<i>No dependency found</i>
	</p>
	<br/>


			<br/>
				<h2><a name="summary">Summary</a></h2>

		<h3><a name="Global variables/contants">Global variables/contants</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a href="#2053c198d3f5f0e74d11dd320768e267">const byte SINLOOKUP[] = {0, 3, 8, 12, 17, 21, 26, 30, 35, 39, 43, 48, 52, 57,</a></code></b>
		</li>
	</ul>


		<h3><a name="Procedures">Procedures</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a href="#54baf06dc970a58e9712b489710a139f">polar_to_cartesian(sword in radius, sword in angle, sword out xpos, sword out ypos)</a></code></b>
		</li>
	</ul>


		<h3><a name="Functions">Functions</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a href="#293e2bff38308f276a09d2664f61a279">sqrt32(dword in x) return word</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#070300ba42c29a3b4e797c98a326d3fc">rsin8(sword in radius, sword in angle) return sword</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#d9c99f57a1f4d9a3990d5b2c32bd492e">abs16(sword in x) return word</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#5f0fb144e4868ea9e2bfadccb9a67d5b">byte_to_fixed(byte in int) return sword</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#52606ee72c17a1c3f61c385c2cf67ae4">sign32(sdword in x) return sbyte</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#1299152b9d73b02f104c385cb67e7c71">rcos8(sword in radius, sword in angle) return sword</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#706bacb3391f2c9941ffa35533feab09">round_fixed(sword in fixed_point) return sbyte </a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#86ebd29bd347b904416b2e6d159331a6">mult_fixed(sword in a, sword in b) return sdword</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#7ddff2d08ffc3de8b8682ec975652757">mod_fixed(sword in a, sword in b) return sword</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#1a60e6ab44df12dacacd0c01b14626ce">abs32(sdword in x) return dword</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#de8bada682e6efd6fcacce867fdc32ba">sqrt16(word in x) return byte</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#86778ee7df98878e9e5c388ffe2727d0">sign8(sbyte in x) return sbyte</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#abf7b206dbf169c2d885c41ea554e400">abs8(sbyte in x) return byte</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#fe06bdcae6c6911ceceeb4908167f967">sign16(sword in x) return sbyte</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#34912653b174fdbde0019ecc6fea66c6">digits_word(word in valu) return byte</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#b0f207a62b4e35d8053f916bfaa73e8b">div_fixed(sword in a, sword in b) return sdword </a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#18f102f3f88e29fd23ca0ee9b420a750">trunc_fixed(sword in fixed_point) return sbyte </a></code></b>
		</li>
	</ul>



			<br/>
				<h2><a name="api">API details</a></h2>

		<h3><a name="Global variables/contants">Global variables/contants</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a name="2053c198d3f5f0e74d11dd320768e267" href="#summary">const byte SINLOOKUP[] = {0, 3, 8, 12, 17, 21, 26, 30, 35, 39, 43, 48, 52, 57,</a></code></b>
				<p>	<pre>
Title:     Obtain sine value
Arguments: - radius (signed word)
 angle in degrees (signed word)
Returns:   signed word
Original:  Michael Watterson
Notes:     Sine values scaled to (256 * 1.0 - 1) for values above zero.
(i.e. add one to lookup if using table directly for other than zeroth Element)
apart from zero, all values are 1 less than actual
to allow storage in 1 byte each
</pre>
</p>
		</li>
	</ul>


		<h3><a name="Procedures">Procedures</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a name="54baf06dc970a58e9712b489710a139f" href="#summary">polar_to_cartesian(sword in radius, sword in angle, sword out xpos, sword out ypos)</a></code></b>
				<p>	<pre>
Title:     Convert polar to cartesian coo-ordinates
Arguments: - radius (signed word)
 angle in degrees (signed word)
Returns:   - X-co-ordinate (signed word)
 Y-co-ordinate (signed word)
Original:  Michael Watterson
Notes:     Use to rotate angle of a line by calculating endpoints.
Use to generate quadrature waves by changing angle at a fixed speed.
If using all 360 degrees in one degree steps, then frequency is step rate / 360

</pre>
</p>
		</li>
	</ul>


		<h3><a name="Functions">Functions</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a name="293e2bff38308f276a09d2664f61a279" href="#summary">sqrt32(dword in x) return word</a></code></b>
				<p>	<pre>
Title:     Calculate the square root of an unsigned 32-bits integer
Arguments: unsigned 32-bits integer
Returns:   unsigned 16-bits integer
Original:  Kyle York

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="070300ba42c29a3b4e797c98a326d3fc" href="#summary">rsin8(sword in radius, sword in angle) return sword</a></code></b>
				<p>	<pre>.
0 to 90 degrees in 1 degree steps
8-bits resolution sin function R x Sin (angle) in degrees -32767 to +32767
Result can be same magnitude and opposite sign
.
Use to generate audio waves by changing angle at a fixed speed.
If using all 360 degrees in one degree steps, then frequency is step rate / 360
At nyquist frequency you only need 0 and 180 degrees, i.e. 1/2 sample rate.
If sample rate is 48kHz then for 12kHz you have only 4 samples,
i.e. 90 degree steps at 1.2kHz thus you use 9 degree steps.
1 degree steps is thus  133.33 Hz if step speed is 48KHz
PWM can be loaded via this lookup
Use 128 and add 127 to answer for 8 bit PWM
Use 512 and add 511 to answer for 10bit PWM
If summing two frequencies, peak value is twice,
so add as swords < 16383 and divide sum by 2!
works with fixed point numbers 256 = 1.0

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="d9c99f57a1f4d9a3990d5b2c32bd492e" href="#summary">abs16(sword in x) return word</a></code></b>
				<p>	<pre>
Title:     Obtain absolute value of a signed 16-bits integer
Arguments: signed 16-bits integer
Returns:   unsigned 16-bits integer
Original:  Eur van Andel

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="5f0fb144e4868ea9e2bfadccb9a67d5b" href="#summary">byte_to_fixed(byte in int) return sword</a></code></b>
				<p>	<pre>
Title:     Convert unsigned 8-bits integer to a signed 16-bits fixed point number
Arguments: unsigned byte
Returns:   signed 16-bits fixed point number
Original:  Michael Watterson

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="52606ee72c17a1c3f61c385c2cf67ae4" href="#summary">sign32(sdword in x) return sbyte</a></code></b>
				<p>	<pre>
Title:     Obtain sign of a signed 32-bits integer
Arguments: signed 32-bits integer
Returns:   signed 8-bits integer
1 : negative
0 : zero
+1 : positive
Original:  Eur van Andel

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="1299152b9d73b02f104c385cb67e7c71" href="#summary">rcos8(sword in radius, sword in angle) return sword</a></code></b>
				<p>	<pre>
Title:     Obtain cosine value
Arguments: - radius (signed word)
 angle in degrees (signed word)
Returns:   a signed word
Original:  Michael Watterson
Notes:     See with rsin8 function

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="706bacb3391f2c9941ffa35533feab09" href="#summary">round_fixed(sword in fixed_point) return sbyte </a></code></b>
				<p>	<pre>
Putpose:   Convert signed 16-bits fixed point number to a signed 8-bits integer (rounded)
Arguments: signed 16-bits fixed point number
Returns:   signed 8-bits integer
Original:  Michael Watterson

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="86ebd29bd347b904416b2e6d159331a6" href="#summary">mult_fixed(sword in a, sword in b) return sdword</a></code></b>
				<p>	<pre>
Title:     Multiply 2 signed 16-bits fixed point numbers
Arguments: 2 signed 16-bits fixed point numbers
Returns:   signed 32-bits fixed point number
Original:  Michael Watterson
Notes:     unlike integer max is 128 * 128  *256 approx

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="7ddff2d08ffc3de8b8682ec975652757" href="#summary">mod_fixed(sword in a, sword in b) return sword</a></code></b>
				<p>	<pre>
Title:     Divide 2 signed 16-bits fixed point numbers
Arguments: 2 signed 16-bits fixed point numbers
Returns:   signed 16-bits number
Original:  Michael Watterson
Notes:     There is probably a better way to do this!

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="1a60e6ab44df12dacacd0c01b14626ce" href="#summary">abs32(sdword in x) return dword</a></code></b>
				<p>	<pre>
Title:     Obtain absolute value of a signed 32-bits integer
Arguments: signed 32-bits integer
Returns:   unsigned 32-bits integer
Original:  Eur van Andel

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="de8bada682e6efd6fcacce867fdc32ba" href="#summary">sqrt16(word in x) return byte</a></code></b>
				<p>	<pre>
Title:     Calculate the square root of an unsigned 16-bits integer
Arguments: unsigned 16-bits integer
Returns:   unsigned 8-bits integer
Original:  author: Kyle York

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="86778ee7df98878e9e5c388ffe2727d0" href="#summary">sign8(sbyte in x) return sbyte</a></code></b>
				<p>	<pre>
Title:     Obtain sign of a signed 8-bits integer
Arguments: signed 8-bits integer
Returns:   signed 8-bits integer
1 : negative
0 : zero
+1 : positive
Original:  Eur van Andel

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="abf7b206dbf169c2d885c41ea554e400" href="#summary">abs8(sbyte in x) return byte</a></code></b>
				<p>	<pre>
Title:     Obtain absolute value of a signed 8-bits integer
Arguments: signed 8-bits integer
Returns:   unsigned 8-bits integer
Original:  Eur van Andel

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="fe06bdcae6c6911ceceeb4908167f967" href="#summary">sign16(sword in x) return sbyte</a></code></b>
				<p>	<pre>
Title:     Obtain sign of a signed 16-bits integer
Arguments: signed 8-bits integer
Returns:   signed 16-bits integer
1 : negative
0 : zero
+1 : positive
Original:  Eur van Andel

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="34912653b174fdbde0019ecc6fea66c6" href="#summary">digits_word(word in valu) return byte</a></code></b>
				<p>	<pre>
Title:     Calculate number of significant decimal digits in an unsigned 16-bits integer
Arguments: unsigned word
Returns:   unsigned byte
Original:  Michael Watterson
Notes:     Uses multiplication by 10 with shifts and addition

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="b0f207a62b4e35d8053f916bfaa73e8b" href="#summary">div_fixed(sword in a, sword in b) return sdword </a></code></b>
				<p>	<pre>
Title:     Divide 2 signed 16-bits fixed point numbers
Arguments: 2 signed 16-bits fixed point numbers
Returns:   signed 32-bits fixed point number
Original:  Michael Watterson

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="18f102f3f88e29fd23ca0ee9b420a750" href="#summary">trunc_fixed(sword in fixed_point) return sbyte </a></code></b>
				<p>	<pre>
Title:     Convert signed 16-bits fixed point number to a signed 8-bits integer (truncated)
Arguments: signed 16-bits fixed point number
Returns:   signed byte
Original:  Michael Watterson

</pre>
</p>
		</li>
	</ul>



			<br/>
				<h2><a name="related_samples">Related samples</a></h2>
	Here are the list of samples which use this library:<br/><br/>
	<table border=1>
			<tr>
			<td><b>16f648a</b></td><td><a href="http://code.google.com/p/jallib/source/browse/trunk/sample/16f648a_sqrt.jal" target="_blank">16f648a_sqrt.jal</a></td>
			</tr>
			<tr>
			<td><b>16f723</b></td><td><a href="http://code.google.com/p/jallib/source/browse/trunk/sample/16f723_sqrt.jal" target="_blank">16f723_sqrt.jal</a></td>
			</tr>
			<tr>
			<td><b>16f73</b></td><td><a href="http://code.google.com/p/jallib/source/browse/trunk/sample/16f73_sqrt.jal" target="_blank">16f73_sqrt.jal</a></td>
			</tr>
			<tr>
			<td><b>16f877</b></td><td><a href="http://code.google.com/p/jallib/source/browse/trunk/sample/16f877_sqrt.jal" target="_blank">16f877_sqrt.jal</a></td>
			</tr>
			<tr>
			<td><b>16f877a</b></td><td><a href="http://code.google.com/p/jallib/source/browse/trunk/sample/16f877a_glcd_ks0108.jal" target="_blank">16f877a_glcd_ks0108.jal</a></td>
			</tr>
			<tr>
			<td><b>16f877a</b></td><td><a href="http://code.google.com/p/jallib/source/browse/trunk/sample/16f877a_sqrt.jal" target="_blank">16f877a_sqrt.jal</a></td>
			</tr>
			<tr>
			<td><b>16f88</b></td><td><a href="http://code.google.com/p/jallib/source/browse/trunk/sample/16f88_sqrt.jal" target="_blank">16f88_sqrt.jal</a></td>
			</tr>
			<tr>
			<td><b>16f886</b></td><td><a href="http://code.google.com/p/jallib/source/browse/trunk/sample/16f886_math.jal" target="_blank">16f886_math.jal</a></td>
			</tr>
			<tr>
			<td><b>18f14k50</b></td><td><a href="http://code.google.com/p/jallib/source/browse/trunk/sample/18f14k50_sqrt.jal" target="_blank">18f14k50_sqrt.jal</a></td>
			</tr>
			<tr>
			<td><b>18f2450</b></td><td><a href="http://code.google.com/p/jallib/source/browse/trunk/sample/18f2450_sqrt.jal" target="_blank">18f2450_sqrt.jal</a></td>
			</tr>
			<tr>
			<td><b>18f2620</b></td><td><a href="http://code.google.com/p/jallib/source/browse/trunk/sample/18f2620_sqrt.jal" target="_blank">18f2620_sqrt.jal</a></td>
			</tr>
			<tr>
			<td><b>18f2685</b></td><td><a href="http://code.google.com/p/jallib/source/browse/trunk/sample/18f2685_math.jal" target="_blank">18f2685_math.jal</a></td>
			</tr>
			<tr>
			<td><b>18f4550</b></td><td><a href="http://code.google.com/p/jallib/source/browse/trunk/sample/18f4550_sqrt.jal" target="_blank">18f4550_sqrt.jal</a></td>
			</tr>
			<tr>
			<td><b>18f6310</b></td><td><a href="http://code.google.com/p/jallib/source/browse/trunk/sample/18f6310_glcd_ks0108.jal" target="_blank">18f6310_glcd_ks0108.jal</a></td>
			</tr>
			<tr>
			<td><b>18f6310</b></td><td><a href="http://code.google.com/p/jallib/source/browse/trunk/sample/18f6310_glcd_ks0108_math.jal" target="_blank">18f6310_glcd_ks0108_math.jal</a></td>
			</tr>
	</table>

			<br/>

            </div>
        </div>


	</body>
</html>

