<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
    <head>
    		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
		<title>co2_t6613_i2c - jallib API doc</title>
    </head>
    <body>
		
		        <div id="page">
        
            <div id="pagecontent">

			    
	<a href="#toc" name="co2_t6613_i2c">
    <h1>co2_t6613_i2c</h1>
	</a>

    <div>
		<font size="+1"><i>co2_t6613_i2c, read values from GE/Telaire T6613 CO2 sensor.</i></font>
	</div>

	<br/>

    <div class="narrow">
        
	<table>
	<tr>
		<td style="border: 1px solid #aaa; padding: 5px;">
			<b>Author</b>
		</td>
		<td style="border: 1px solid #aaa; padding: 5px;">
			Eur van Andel, eur@fiwihex.nl Copyright &copy; 2013
		</td>
	</tr>
	<tr>
		<td style="border: 1px solid #aaa; padding: 5px;">
			<b>Adapted-by</b>
		</td>
		<td style="border: 1px solid #aaa; padding: 5px;">
			
		</td>
	</tr>
	<tr>
		<td style="border: 1px solid #aaa; padding: 5px;">
			<b>Compiler</b>
		</td>
		<td style="border: 1px solid #aaa; padding: 5px;">
			=2.4o
		</td>
	</tr>
	</table>

	<br/>
	
	<b>Description</b>
	<p>
		<pre>This library communicates with the T6613 GE/Telaire CO2 sensor, 
via I2C. The protocol doc isn't on the web: email eur@fiwihex.nl to get it.
available functions are:
get_status() return byte
get_co2_ppm() return word           -- CO2 concentration in ppm 
get_serial_numer() return string[15]
get_elevation_m() return word       -- in meters above sea level


-------
declare in your main program, before including this library:
const word _i2c_bus_speed = 1 -- * 100kHz
const bit _i2c_level = true   
include i2c_hardware                         -- there is software i2c too
i2c_initialize()
var bit tx_ok                                        -- check if all transmissions went OK


---------
</pre>

	</p>
	<br/>


	<b>Notes</b>
	<p>
		<pre>sensor pinout, top view: (gold box visible)
A B C 2 4 6 8 10 12
      1 3 5 7  9 11
where:
A    TX (UART)
B    RX (UART)
C    V+ (5V DC)
1 +5V
2    GND
3    GND
4    AV OUT (0..4V DC)
5    SCL (I2C)
6    NC
7    SDA (I2C)       
8    NC
9    NC
10   TX (UART)
11   RX (UART)
12   GND
for this library, you need only connect pins 1, 3, 5 & 7


--------------
Memory map:
T66xx memory map                                                     
     addr    Description     lt      wgt  RW/RO      write            read description        write description
     0x00    Elevation       2       msb     RW      W: 0 xx xx                              xx xx elevation in hex
     0x01                            lsb                             
     0x02    Span PPM        2       msb     RW      W: 2 xx xx                              xx xx span in hex T6615 only
     0x03                            lb                             
     0x04    sngl p trgt     2       msb     RW      W: 4 xx xx                               xx xx single point in hex
     0x05                            lsb                             
     0x06    zero cal cmd    1               RW      W: 6 0F         00: flags set   
     0x07    span cal cmd    1               RW      W: 7 0F         00: flags set           T6615 only
     0x08    sngl pnt cal cmd 1              RW      W: 8 0F         00: flags set   
     0x09    ABC logic enable 1              RW      W: 9 0x         01:ABC on, 02:ABC off 01:on, 02:off, 03:reset and on
     0x0A    Sensor idle cmd 1               RW      W: A 0x         00 after cmd            01:idle on, 02:idle off
     0x0B    Reset cmd       1               RW      W: B 0F         00 after cmd    
     0x0C    span2 cal cmd   1               RW      W: C 0F         00: flags set           T6615 only
     0x0D    span2 ppm       2               RW      W: D xx xx      
</pre>

	</p>
	<br/>
	
	<b>Dependencies</b>
	<p>
		<i>No dependency found</i>
	</p>
	<br/>


			<br/>
				<h2><a name="summary">Summary</a></h2>

		<h3><a name="Global variables/contants">Global variables/contants</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a href="#c6db8ee74a0980446c53e0ab2ac03137">const CMD_CO2           = 0x20</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#f4c9598a3aacbff9481fbc39ce37cd7a">const CMD_RESET         = 0x0B</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#079c7819eba147f7335f8f87ca3c5541">const CMD_ELEVATION     = 0x00</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#caf4a69b1ee5f7f09bee9b2ff2edf582">const CMD_SERIAL        = 0x27</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#d10b95ea313d01c720d6a568f347ac25">const byte t6613_addr   = 0b0001_0000  </a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#e7204629438927708f566cef9c567ade">const CMD_STATUS        = 0x22</a></code></b>
		</li>
	</ul>


		<h3><a name="Procedures">Procedures</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a href="#456bc682e1aef2c606ee71ae080c4a98">set_co2_elevation_m(word in meters)</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#184fd0447c3ed3d4b85ab8e0b9f4bb8f">get_co2_serial_number(byte out str[16])</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#a4b4faa09ad6eaef8e616756574826b0">reset_t6613()</a></code></b>
		</li>
	</ul>


		<h3><a name="Functions">Functions</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a href="#41fe036619a26d25da7e68ac3bb4f84f">get_co2_elevation_m() return word</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#5d48ecaaa9459dc9dd6deae8b3b9ac46">get_co2_ppm() return word</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#adc8740114e9146052ab2cb5e803bbca">get_co2_status() return byte</a></code></b>
		</li>
	</ul>



			<br/>
				<h2><a name="api">API details</a></h2>

		<h3><a name="Global variables/contants">Global variables/contants</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a name="c6db8ee74a0980446c53e0ab2ac03137" href="#summary">const CMD_CO2           = 0x20</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="f4c9598a3aacbff9481fbc39ce37cd7a" href="#summary">const CMD_RESET         = 0x0B</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="079c7819eba147f7335f8f87ca3c5541" href="#summary">const CMD_ELEVATION     = 0x00</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="caf4a69b1ee5f7f09bee9b2ff2edf582" href="#summary">const CMD_SERIAL        = 0x27</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="d10b95ea313d01c720d6a568f347ac25" href="#summary">const byte t6613_addr   = 0b0001_0000  </a></code></b>
				<p>	<pre>0x08 in 7-bit notation</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="e7204629438927708f566cef9c567ade" href="#summary">const CMD_STATUS        = 0x22</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
	</ul>


		<h3><a name="Procedures">Procedures</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a name="456bc682e1aef2c606ee71ae080c4a98" href="#summary">set_co2_elevation_m(word in meters)</a></code></b>
				<p>	<pre>should set elevation in meters above sea level, not implemented yet
</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="184fd0447c3ed3d4b85ab8e0b9f4bb8f" href="#summary">get_co2_serial_number(byte out str[16])</a></code></b>
				<p>	<pre>returns 16 byte ASCII string, which should be the same
as the number on the sticker
</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="a4b4faa09ad6eaef8e616756574826b0" href="#summary">reset_t6613()</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
	</ul>


		<h3><a name="Functions">Functions</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a name="41fe036619a26d25da7e68ac3bb4f84f" href="#summary">get_co2_elevation_m() return word</a></code></b>
				<p>	<pre>returns programmed elevation above sea level in meters
this elevation is used to calculate CO2 concentration correctly
</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="5d48ecaaa9459dc9dd6deae8b3b9ac46" href="#summary">get_co2_ppm() return word</a></code></b>
				<p>	<pre>returns a word with CO2 concentration in ppm
</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="adc8740114e9146052ab2cb5e803bbca" href="#summary">get_co2_status() return byte</a></code></b>
				<p>	<pre>returns status byte. bit_0 = error, bit_1 = warmup, 
bit_2 = calibration, bit_3 = idle
</pre>
</p>
		</li>
	</ul>



			<br/>
				<h2><a name="related_samples">Related samples</a></h2>
	Here are the list of samples which use this library:<br/><br/>
	<table border=1>
			<tr>
			<td><b>18f67k22</b></td><td><a href="http://code.google.com/p/jallib/source/browse/trunk/sample/18f67k22_co2_i2c.jal" target="_blank">18f67k22_co2_i2c.jal</a></td>
			</tr>
	</table>

			<br/>

            </div>
        </div>


	</body>
</html>

