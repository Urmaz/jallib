<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
    <head>
		<title>smbus_mlx90615 - jallib API doc</title>
    </head>
    <body>
		
		        <div id="page">
        
            <div id="pagecontent">

			    
	<a href="#toc" name="smbus_mlx90615">
    <h1>smbus_mlx90615</h1>
	</a>

    <div>
		<font size="+1"><i>SM bus library for Melexis IR sensor MLX90615</i></font>
	</div>

	<br/>

    <div class="narrow">
        
	<table>
	<tr>
		<td style="border: 1px solid #aaa; padding: 5px;">
			<b>Author</b>
		</td>
		<td style="border: 1px solid #aaa; padding: 5px;">
			Vasile Surducan, Copyright &copy; 2010...2012, all rights reserved.
		</td>
	</tr>
	<tr>
		<td style="border: 1px solid #aaa; padding: 5px;">
			<b>Adapted-by</b>
		</td>
		<td style="border: 1px solid #aaa; padding: 5px;">
			
		</td>
	</tr>
	<tr>
		<td style="border: 1px solid #aaa; padding: 5px;">
			<b>Compiler</b>
		</td>
		<td style="border: 1px solid #aaa; padding: 5px;">
			>=2.4m
		</td>
	</tr>
	</table>

	<br/>
	
	<b>Description</b>
	<p>
		<pre>software implementation for single SMbus master, use 4 hw stack
</pre>

	</p>
	<br/>


	
	<b>Dependencies</b>
	<p>
		<ul>
			<li><a href="delay.html">delay</a></li>
		</ul>


			<br/>
				<h2><a name="summary">Summary</a></h2>

		<h3><a name="Global variables/contants">Global variables/contants</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a href="#ba667dbd00f1b2a0b907bb727a021f18">const id_number1 = 0x0F ; read only</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#0288d93535c48d2de2844b5d4266133d">var word temp = 0</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#ce4af163f8995d9456feb3340f3684b8">var byte mem_low = 0</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#b0ab779243ec087e64b41ccdbf1f6835">var volatile bit pwm_frequency at config: 1   ; 1=low,      0=high</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#0044439a4f5deb7518aa54c3b01dd844">var word config</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#47c44704d82277a54cc4f4b384765016">const raw_ir_data = 0x05</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#5ba642eb9ae63940de45b4ed68e35048">var word temperature_k = 0</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#29995ec0a71cda96b86798613572519f">const tambiant = 0x06</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#bb796b1ab808659a844e487d446de11b">const emissivity = 0x03</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#4205ca0ca71ba271585f9ff0b5442fa4">var volatile bit*3 iir_setting at config: 12  ; see table below</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#ddc3d3794e9de22ec2b9f74019435654">var word  w_t_high = 0</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#41595e46654a9cd40489ae749396423b">var sword temperature_c = 0</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#5c8da5dd47a1b44813bf49ed5a05a538">var byte mem_high = 0</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#fffd472b4299414a1ee7d5b468ec4f54">var byte t_high = 0</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#d5955068c47c8f12fa3e1bcb31500a57">var volatile bit zero at config: 15           ; keep 0</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#56373327e60cea9b29860e63c0a62b8f">const config_reg = 0x02</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#839719875214949cdbf4e71083028451">const bit ACK = low</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#a6dbe06885b36e0c880d5ac6e8d8bc4a">const pwm_t_range = 0x01</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#6e0b3aba24d6a700943db771adca8f57">const bit NACK = high</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#6cbac751d5cea0080fd94ef6712b544e">const tobject = 0x07</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#e8fdba2bb3dc1cc0ff3f617e7861f597">var sword temperature = 0</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#924059108802babe047c55a1545aa8d3">const id_number0 = 0x0E ; read only</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#3d78eca14d28958b32d13fae0e32f2f3">const eeprom_access = 0b0001_0000</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#b16a8d2a7cfca5fad9784a89e8f854b7">var volatile bit*9 factory_cal at config: 3   ; do not alter</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#fe72d5dc2dc2a3bb91859235be4cfdf0">const sleep_mode = 0b1100_0110</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#9b2d80d0b8cb091c6733597484348ba2">const smbus_sa = 0 ; SMbus Slave Address 7 bit, 0 to 6; 0x5b factory default</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#e395681879334d9049f1c18976b85928">var sword s_t_high = 0</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#ffb704357cbe32a7b1fa4aee52148d5e">var bit mlx90615_ack = high</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#2ff58f4f584ec4baf10570702b170ac6">const ram_access = 0b0010_0000</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#871c9d491e72b441f491c54d20e1f818">var byte pec = 0</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#8fa579e3f110a08fdceef9bc1c861b7b">var volatile bit mode_select at config: 0     ; 1=SMbus,    0=PWM</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#619cad734e6bd3cf0ca4e0d62f9b3dcc">var volatile bit pwm_output_temp at config: 2 ; 1=Tambiant, 0=Tobject</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#f3a7c935a6e45b26ac2232cce4e93759">const sword c27315 = 27315</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#8de1c940f1acad1f8942096c2571bd68">var byte nack_counter = 0</a></code></b>
		</li>
	</ul>


		<h3><a name="Procedures">Procedures</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a href="#583cbd383a9b232d4014c96e0e14a555">mlx90615_sleep( byte in senzor_address )</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#0e20d32ab67d29b48380b48c44283ba5">calculate_temp_k()</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#bc51cb36be52ba40de75df475e7099e9">mlx90615_wake()</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#4db17884bfcecd6ddf264ae73f942e34">calculate_temp_c()</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#80ef68402ff9b93e6882a34c27f59008">sm_start_bit()</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#fe6fdecc9e3dc924e57aec338415d2b2">sm_stop_bit()</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#983d1612cd8151a7232d049c3a126c2f">sm_bus_initialize() is ; not necesary if SMbus</a></code></b>
		</li>
	</ul>

	<i><small>Private</small></i>
		<ul>
		<li>
				<b><code name="code" class="python"><a href="#44fd9cbc42b89f1b72990d63acf44bd9">_scl_high()</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#7345282c841729a55da968bb138f180c">_sda_high()</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#f26ece046046f82c80fee8c1d81605fb">_scl_low()</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#291116b748c8f4145f39ed029e1d9e57">_sm_send_bit(bit in x)</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#29408f3c750ce7fce5108ce81d719128">_sda_low()</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#5e1f97c3dfb29ea9d3ea146a4abd7308">_sm_receive_bit(bit out x)</a></code></b>
		</li>
	</ul>

	<br/>

		<h3><a name="Functions">Functions</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a href="#71c456199d43756c8711b24907bb894b">sm_transmit_byte(byte in tx_buffer) return bit</a></code></b>
		</li>
		<li>
				<b><code name="code" class="python"><a href="#c2a5afd6da697205b63182b4d4eaf33b">sm_receive_byte(bit in ack_noack) return byte</a></code></b>
		</li>
	</ul>



			<br/>
				<h2><a name="api">API details</a></h2>

		<h3><a name="Global variables/contants">Global variables/contants</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a name="ba667dbd00f1b2a0b907bb727a021f18" href="#summary">const id_number1 = 0x0F ; read only</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="0288d93535c48d2de2844b5d4266133d" href="#summary">var word temp = 0</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="ce4af163f8995d9456feb3340f3684b8" href="#summary">var byte mem_low = 0</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="b0ab779243ec087e64b41ccdbf1f6835" href="#summary">var volatile bit pwm_frequency at config: 1   ; 1=low,      0=high</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="0044439a4f5deb7518aa54c3b01dd844" href="#summary">var word config</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="47c44704d82277a54cc4f4b384765016" href="#summary">const raw_ir_data = 0x05</a></code></b>
				<p>	<pre>0x04 to 0x4h Melexis reserved
</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="5ba642eb9ae63940de45b4ed68e35048" href="#summary">var word temperature_k = 0</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="29995ec0a71cda96b86798613572519f" href="#summary">const tambiant = 0x06</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="bb796b1ab808659a844e487d446de11b" href="#summary">const emissivity = 0x03</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="4205ca0ca71ba271585f9ff0b5442fa4" href="#summary">var volatile bit*3 iir_setting at config: 12  ; see table below</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="ddc3d3794e9de22ec2b9f74019435654" href="#summary">var word  w_t_high = 0</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="41595e46654a9cd40489ae749396423b" href="#summary">var sword temperature_c = 0</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="5c8da5dd47a1b44813bf49ed5a05a538" href="#summary">var byte mem_high = 0</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="fffd472b4299414a1ee7d5b468ec4f54" href="#summary">var byte t_high = 0</a></code></b>
				<p>	<pre>var byte t_low = 0
</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="d5955068c47c8f12fa3e1bcb31500a57" href="#summary">var volatile bit zero at config: 15           ; keep 0</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="56373327e60cea9b29860e63c0a62b8f" href="#summary">const config_reg = 0x02</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="839719875214949cdbf4e71083028451" href="#summary">const bit ACK = low</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="a6dbe06885b36e0c880d5ac6e8d8bc4a" href="#summary">const pwm_t_range = 0x01</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="6e0b3aba24d6a700943db771adca8f57" href="#summary">const bit NACK = high</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="6cbac751d5cea0080fd94ef6712b544e" href="#summary">const tobject = 0x07</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="e8fdba2bb3dc1cc0ff3f617e7861f597" href="#summary">var sword temperature = 0</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="924059108802babe047c55a1545aa8d3" href="#summary">const id_number0 = 0x0E ; read only</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="3d78eca14d28958b32d13fae0e32f2f3" href="#summary">const eeprom_access = 0b0001_0000</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="b16a8d2a7cfca5fad9784a89e8f854b7" href="#summary">var volatile bit*9 factory_cal at config: 3   ; do not alter</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="fe72d5dc2dc2a3bb91859235be4cfdf0" href="#summary">const sleep_mode = 0b1100_0110</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="9b2d80d0b8cb091c6733597484348ba2" href="#summary">const smbus_sa = 0 ; SMbus Slave Address 7 bit, 0 to 6; 0x5b factory default</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="e395681879334d9049f1c18976b85928" href="#summary">var sword s_t_high = 0</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="ffb704357cbe32a7b1fa4aee52148d5e" href="#summary">var bit mlx90615_ack = high</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="2ff58f4f584ec4baf10570702b170ac6" href="#summary">const ram_access = 0b0010_0000</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="871c9d491e72b441f491c54d20e1f818" href="#summary">var byte pec = 0</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="8fa579e3f110a08fdceef9bc1c861b7b" href="#summary">var volatile bit mode_select at config: 0     ; 1=SMbus,    0=PWM</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="619cad734e6bd3cf0ca4e0d62f9b3dcc" href="#summary">var volatile bit pwm_output_temp at config: 2 ; 1=Tambiant, 0=Tobject</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="f3a7c935a6e45b26ac2232cce4e93759" href="#summary">const sword c27315 = 27315</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="8de1c940f1acad1f8942096c2571bd68" href="#summary">var byte nack_counter = 0</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
	</ul>


		<h3><a name="Procedures">Procedures</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a name="583cbd383a9b232d4014c96e0e14a555" href="#summary">mlx90615_sleep( byte in senzor_address )</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="0e20d32ab67d29b48380b48c44283ba5" href="#summary">calculate_temp_k()</a></code></b>
				<p>	<pre>
conversion to kelvin

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="bc51cb36be52ba40de75df475e7099e9" href="#summary">mlx90615_wake()</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="4db17884bfcecd6ddf264ae73f942e34" href="#summary">calculate_temp_c()</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="80ef68402ff9b93e6882a34c27f59008" href="#summary">sm_start_bit()</a></code></b>
				<p>	<pre>
SMbus start bit

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="fe6fdecc9e3dc924e57aec338415d2b2" href="#summary">sm_stop_bit()</a></code></b>
				<p>	<pre>
SMbus stop bit

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="983d1612cd8151a7232d049c3a126c2f" href="#summary">sm_bus_initialize() is ; not necesary if SMbus</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
	</ul>

	<i><small>Private</small></i>
		<ul>
		<li>
				<b><code name="code" class="python"><a name="44fd9cbc42b89f1b72990d63acf44bd9" href="#summary">_scl_high()</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="7345282c841729a55da968bb138f180c" href="#summary">_sda_high()</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="f26ece046046f82c80fee8c1d81605fb" href="#summary">_scl_low()</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="291116b748c8f4145f39ed029e1d9e57" href="#summary">_sm_send_bit(bit in x)</a></code></b>
				<p>	<pre>
Transmit one bit on SM bus (for internal use only )

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="29408f3c750ce7fce5108ce81d719128" href="#summary">_sda_low()</a></code></b>
				<p><i>No documentation found</i></p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="5e1f97c3dfb29ea9d3ea146a4abd7308" href="#summary">_sm_receive_bit(bit out x)</a></code></b>
				<p>	<pre>
Receive one bit on SM bus (for internal use only)

</pre>
</p>
		</li>
	</ul>

	<br/>

		<h3><a name="Functions">Functions</a></h3>
		<ul>
		<li>
				<b><code name="code" class="python"><a name="71c456199d43756c8711b24907bb894b" href="#summary">sm_transmit_byte(byte in tx_buffer) return bit</a></code></b>
				<p>	<pre>
Transmit one byte on SM bus

</pre>
</p>
		</li>
		<li>
				<b><code name="code" class="python"><a name="c2a5afd6da697205b63182b4d4eaf33b" href="#summary">sm_receive_byte(bit in ack_noack) return byte</a></code></b>
				<p>	<pre>
Receive one byte on SM bus

</pre>
</p>
		</li>
	</ul>



			<br/>
				<h2><a name="related_samples">Related samples</a></h2>
	Here are the list of samples which use this library:<br/><br/>
	<table border=1>
			<tr>
			<td><b>18f25j10</b></td><td><a href="http://code.google.com/p/jallib/source/browse/trunk/sample/18f25j10_test_mlx90615.jal" target="_blank">18f25j10_test_mlx90615.jal</a></td>
			</tr>
	</table>

			<br/>

            </div>
        </div>


	</body>
</html>

