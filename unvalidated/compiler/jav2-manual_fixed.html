<a name="top"><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
        <META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=iso-8859-1">
        <TITLE>JalV2 User's Guide</TITLE>
        <META NAME="GENERATOR" CONTENT="OpenOffice.org 2.4  (Linux)">
        <META NAME="CREATED" CONTENT="20070503;15382900">
        <META NAME="CHANGED" CONTENT="20081217;16423300">
        <STYLE TYPE="text/css">
        <!--
                @page { size: 8.27in 11.69in; margin: 0.79in }
                TD P { margin-bottom: 0.08in }
                H1 { margin-bottom: 0.08in }
                H1.western { font-family: "Arial", sans-serif; font-size: 16pt }
                H1.cjk { font-family: "Mincho"; font-size: 16pt }
                H1.ctl { font-family: "Lucidasans"; font-size: 16pt }
                P { margin-bottom: 0.08in }
                H2 { margin-bottom: 0.08in }
                H2.western { font-family: "Arial", sans-serif; font-size: 12pt; font-style: normal }
                H2.cjk { font-family: "Mincho"; font-size: 14pt; font-style: italic }
                H2.ctl { font-size: 14pt; font-style: italic }
                TH P { margin-bottom: 0.08in }
                A:link { background: transparent }
                A.western:link { font-weight: medium }
        -->
        </STYLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<DIV ID="Table of Contents1" DIR="LTR">
        <P><BR><BR>
        </P>
        <DIV ID="Table of Contents1_Head" DIR="LTR">
                <P STYLE="margin-top: 0.17in; margin-bottom: 0.2in; page-break-after: avoid">
                <FONT FACE="Albany, sans-serif"><FONT SIZE=4 STYLE="font-size: 16pt"><B>Table
                of Contents</B></FONT></FONT></P>
        </DIV>
        <P STYLE="margin-bottom: 0in"><A CLASS="western" HREF="#0.1. Introduction|outline">1.
        Introduction</A></P>
        <P STYLE="margin-bottom: 0in"><A CLASS="western" HREF="#0.2. Conventions Used in This Text|outline">2.
        Conventions Used in This Text</A></P>
        <P STYLE="margin-bottom: 0in"><A CLASS="western" HREF="#0.3. Program Structure|outline">3.
        Program Structure</A></P>
        <P STYLE="margin-bottom: 0in"><A CLASS="western" HREF="#0.4. Identifiers|outline">4.
        Identifiers</A></P>
        <P STYLE="margin-bottom: 0in"><A CLASS="western" HREF="#0.5. Types|outline">5.
        Types</A></P>
        <P STYLE="margin-left: 0.2in; margin-bottom: 0in"><A CLASS="western" HREF="#0.0.5.1 BIT|outline">5.1
        BIT</A></P>
        <P STYLE="margin-left: 0.2in; margin-bottom: 0in"><A CLASS="western" HREF="#0.0.5.2 BYTE[*cexpr]|outline">5.2
        BYTE[*cexpr]</A></P>
        <P STYLE="margin-left: 0.2in; margin-bottom: 0in"><A CLASS="western" HREF="#0.0.5.3 SBYTE[*cexpr]|outline">5.3
        SBYTE[*cexpr]</A></P>
        <P STYLE="margin-left: 0.2in; margin-bottom: 0in"><A CLASS="western" HREF="#0.0.5.4 Universal|outline">5.4
        Universal</A></P>
        <P STYLE="margin-bottom: 0in"><A CLASS="western" HREF="#0.6. Constants|outline">6.
        Constants</A></P>
        <P STYLE="margin-left: 0.2in; margin-bottom: 0in"><A CLASS="western" HREF="#0.0.6.1 Literal|outline">6.1
        Literal</A></P>
        <P STYLE="margin-left: 0.2in; margin-bottom: 0in"><A CLASS="western" HREF="#0.0.6.2 Named|outline">6.2
        Named</A></P>
        <P STYLE="margin-bottom: 0in"><A CLASS="western" HREF="#0.7. Variables|outline">7.
        Variables</A></P>
        <P STYLE="margin-bottom: 0in"><A CLASS="western" HREF="#0.8. Expressions|outline">8.
        Expressions</A></P>
        <P STYLE="margin-bottom: 0in"><A CLASS="western" HREF="#0.9. Flow Control|outline">9.
        Flow Control</A></P>
        <P STYLE="margin-left: 0.2in; margin-bottom: 0in"><A CLASS="western" HREF="#0.0.9.1 BLOCK|outline">9.1
        BLOCK</A></P>
        <P STYLE="margin-left: 0.2in; margin-bottom: 0in"><A CLASS="western" HREF="#0.0.9.2 CASE|outline">9.2
        CASE</A></P>
        <P STYLE="margin-left: 0.2in; margin-bottom: 0in"><A CLASS="western" HREF="#0.0.9.3 FOR|outline">9.3
        FOR</A></P>
        <P STYLE="margin-left: 0.2in; margin-bottom: 0in"><A CLASS="western" HREF="#0.0.9.4 FOREVER|outline">9.4
        FOREVER</A></P>
        <P STYLE="margin-left: 0.2in; margin-bottom: 0in"><A CLASS="western" HREF="#0.0.9.5 IF|outline">9.5
        IF</A></P>
        <P STYLE="margin-left: 0.2in; margin-bottom: 0in"><A CLASS="western" HREF="#0.0.9.6 REPEAT|outline">9.6
        REPEAT</A></P>
        <P STYLE="margin-left: 0.2in; margin-bottom: 0in"><A CLASS="western" HREF="#0.0.9.7 WHILE|outline">9.7
        WHILE</A></P>
        <P STYLE="margin-bottom: 0in"><A CLASS="western" HREF="#0.10. Sub-programs : Procedures and Functions|outline">10.
        Sub-programs : Procedures and Functions</A></P>
        <P STYLE="margin-bottom: 0in"><A CLASS="western" HREF="#0.11. Pseudo-variables|outline">11.
        Pseudo-variables</A></P>
        <P STYLE="margin-bottom: 0in"><A CLASS="western" HREF="#0.12. Interrupts|outline">12.
        Interrupts</A></P>
        <P STYLE="margin-bottom: 0in"><A CLASS="western" HREF="#0.13. Tasks|outline">13.
        Tasks</A></P>
        <P STYLE="margin-bottom: 0in"><A CLASS="western" HREF="#0.14. Assembly|outline">14.
        Assembly</A></P>
</DIV>
<P><BR><BR>
</P>
<a name="#0.1. Introduction|outline"><H1 CLASS="western">1. Introduction</H1>
<P STYLE="margin-bottom: 0in">This text is not meant to be a
programming tutorial &ndash; the reader is expected to have some
programming background and understand concepts like procedure,
functions, variables, etc. Many good web sites and a yahoo discussion
group exist to help with any questions.</P>
<P>JALv2 builds on the original JAL which is loosely based on Pascal.
Like Pascal, identifiers are not case sensitive and procedures and
functions can be defined and nested. Unlike Pascal statement blocks
do not require an explicit BEGIN and END statement, and variables,
procedures, and functions can be defined anywhere in the program.
</P>
<P>Much like C, there are very few keywords and built-in functions.
With the availability of sub-programs, any function can be created in
the language itself. This simplifies the compiler and supporting
libraries. The exception to this is multiplication, division, and
modulus. These are far easier to create within the compiler and make
a much more logical looking language. For example, instead of
writing:</P>
<P STYLE="margin-left: 0.5in"><FONT FACE="Courier, monospace"><FONT SIZE=2>z
= multiply ( x, y )</FONT></FONT></P>
<P>we need write only:</P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>z
= x * y</FONT></FONT></P>
<P>This also allows for some optimization by the compiler -- if <FONT FACE="Courier, monospace"><FONT SIZE=2>y</FONT></FONT>
is a power of two, the multiply or divide is replaced by a shift of
the appropriate amount.</P>
<P>The only other exception to the built-in rule is:</P>
<P STYLE="margin-left: 0.5in"><FONT FACE="Courier, monospace"><FONT SIZE=2>_usec_delay(cexpr)</FONT></FONT></P>
<P>This built-in generates the correct number of instructions to
guarantee the delay is exactly the required length (assuming
interrupts are not enabled). This is accomplished using one, two or
three nested loops along with however many <FONT FACE="Courier, monospace"><FONT SIZE=2>nop</FONT></FONT>
instructions are required to complete.</P>
<P>JAL is a free flowing language -- there is no limit on the length
of a line. An entire program can occupy a single line! Comments are
preceded by either two dashes (&quot;<FONT FACE="Courier, monospace"><FONT SIZE=2>--</FONT></FONT>&quot;)
or a semi-colon (&quot;<FONT FACE="Courier, monospace"><FONT SIZE=2>;</FONT></FONT>&quot;).
Once a comment mark has been found, the comment continues until the
end of the current line.</P>
<a name="#0.2. Conventions Used in This Text|outline"><H1 CLASS="western">2. Conventions Used in This Text</H1>
<P><FONT FACE="Courier, monospace"><FONT SIZE=2>Fixed Font</FONT></FONT>
: JALv2 program</P>
<P><FONT FACE="Courier, monospace"><FONT SIZE=2>UPPER CASE</FONT></FONT>
: a JALv2 keyword</P>
<P><FONT FACE="Courier, monospace"><FONT SIZE=2>expr</FONT></FONT>: a
constant or variable expression</P>
<P><FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr</FONT></FONT>:
a constant expression (one consisting of only constant operations)</P>
<P><FONT FACE="Courier, monospace"><FONT SIZE=2>[...]</FONT></FONT> :
an optional argument</P>
<P><FONT FACE="Courier, monospace"><FONT SIZE=2>{ ... | ... }</FONT></FONT>
: choose one of the options</P>
<P><FONT FACE="Courier, monospace"><FONT SIZE=2>statement</FONT></FONT>
: a single JALv2 statement (assignment, flow control, etc.)</P>
<P><FONT FACE="Courier, monospace"><FONT SIZE=2>statement block</FONT></FONT>
: one or more JALv2 statements; implies a block</P>
<a name="#0.3. Program Structure|outline"><H1 CLASS="western">3. Program Structure</H1>
<P>A program is a series of statements. Like BASIC, the statements
simply begin. Procedures and Functions are skipped unless explicitly
called. Identifier scoping looks like:</P>
<P><BR><BR>
</P>
<TABLE WIDTH=302 BORDER=1 CELLPADDING=4 CELLSPACING=3>
        <COL WIDTH=286>
        <TR>
                <TD WIDTH=286 VALIGN=TOP>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>Program Scope:
                        A,B,C</FONT></FONT></P>
                </TD>
        </TR>
        <TR>
                <TD WIDTH=286 VALIGN=TOP>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>Procedure proc1:
                        A1,B1,C1</FONT></FONT></P>
                </TD>
        </TR>
        <TR>
                <TD WIDTH=286 VALIGN=TOP>
                        <P><BR>
                        </P>
                </TD>
        </TR>
        <TR>
                <TD WIDTH=286 VALIGN=TOP>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>Procedure proc2:
                        A2,B2,C2</FONT></FONT></P>
                </TD>
        </TR>
        <TR>
                <TD WIDTH=286 VALIGN=TOP>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>Procedure proc2a:
                        a2a, b2a, c2a</FONT></FONT></P>
                </TD>
        </TR>
        <TR>
                <TD WIDTH=286 VALIGN=TOP>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>Procedure proc2b:
                        a2b, b2b, c2b</FONT></FONT></P>
                </TD>
        </TR>
        <TR>
                <TD WIDTH=286 VALIGN=TOP>
                        <P><BR>
                        </P>
                </TD>
        </TR>
</TABLE>
<P><BR><BR>
</P>
<P>Here, all procedures can see the global identifiers (A, B, C). The
global procedure (main program) can see proc1 and proc2, but not
identifiers defined in proc1, or proc2 (so it cannot see proc2a or
proc2b). Proc2 can see proc2a and proc2b. Proc2a and proc2b can see
A2, B2, C2, proc1, A, B, and C</P>
<a name="#0.4. Identifiers|outline"><H1 CLASS="western">4. Identifiers</H1>
<P>An identifier may begin with an underscore (&ldquo;_&rdquo;) or a
letter, and may be followed by any number of letters, numbers, or
underscores. By convention, all identifiers beginning with &ldquo;_&rdquo;
are reserved by the compiler for internal use.</P>
<P>JAL is <B>not</B> case sensitive, so program, Program, and PROGRAM
all represent the same identifier. The scope, or life, of an
identifier is the closest enclosing block. Blocks are either
implicitly started (for example, whenever a <FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT> is encountered), or explicitly with the BLOCK
command. All identifiers within a block must be unique, but the same
identifier may be used inside nested blocks. For example:</P>
<P STYLE="margin-left: 0.51in; font-weight: medium"><FONT FACE="Courier, monospace"><FONT SIZE=2>VAR
BYTE x</FONT></FONT></P>
<P STYLE="margin-left: 0.51in; font-weight: medium"><FONT FACE="Courier, monospace"><FONT SIZE=2>VAR
BIT x</FONT></FONT></P>
<P STYLE="font-weight: medium">is an error, because <FONT FACE="Courier, monospace"><FONT SIZE=2>x</FONT></FONT>
has been defined twice. However,</P>
<P STYLE="margin-left: 0.5in; font-weight: medium"><FONT FACE="Courier, monospace"><FONT SIZE=2>VAR
BYTE x</FONT></FONT></P>
<P STYLE="margin-left: 0.51in; font-weight: medium"><FONT FACE="Courier, monospace"><FONT SIZE=2>BLOCK</FONT></FONT></P>
<P STYLE="margin-left: 0.65in; font-weight: medium"><FONT FACE="Courier, monospace"><FONT SIZE=2>VAR
BIT x</FONT></FONT></P>
<P STYLE="margin-left: 0.65in; font-weight: medium"><FONT FACE="Courier, monospace"><FONT SIZE=2>...</FONT></FONT></P>
<P STYLE="margin-left: 0.5in; font-weight: medium"><FONT FACE="Courier, monospace"><FONT SIZE=2>END
BLOCK</FONT></FONT></P>
<P STYLE="font-weight: medium">is not an error, because <FONT FACE="Courier, monospace"><FONT SIZE=2>x</FONT></FONT>
(the <FONT FACE="Courier, monospace"><FONT SIZE=2>BIT</FONT></FONT>)
is defined in a different block. This is generally a bad idea since
when reading the program one might be confused about what <FONT FACE="Courier, monospace"><FONT SIZE=2>x</FONT></FONT>
is.</P>
<a name="#0.5. Types|outline"><H1 CLASS="western">5. Types</H1>
<P>There are three of variables in JALv2 &ndash; <FONT FACE="Courier, monospace"><FONT SIZE=2>BIT</FONT></FONT>,
<FONT FACE="Courier, monospace"><FONT SIZE=2>BYTE</FONT></FONT>, and
<FONT FACE="Courier, monospace"><FONT SIZE=2>SBYTE</FONT></FONT>.</P>
<a name="#0.0.5.1 BIT|outline""><H2 CLASS="western">5.1 BIT</H2>
<P>A single bit variable useful for addressing individual pins in a
port for example.</P>
<a name="#0.0.5.2 BYTE[*cexpr]|outline""><H2 CLASS="western">5.2 BYTE[*cexpr]</H2>
<P>A single or multi-byte unsigned variable. <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr</FONT></FONT>,
if present, sets the width (in BYTEs). JALv2 has two useful aliases,
<FONT FACE="Courier, monospace"><FONT SIZE=2>WORD</FONT></FONT> which
is <FONT FACE="Courier, monospace"><FONT SIZE=2>BYTE*2</FONT></FONT>,
and <FONT FACE="Courier, monospace"><FONT SIZE=2>DWORD</FONT></FONT>
which is <FONT FACE="Courier, monospace"><FONT SIZE=2>BYTE*4</FONT></FONT>.
These are not the only allowed sizes. It is useful to have <FONT FACE="Courier, monospace"><FONT SIZE=2>BYTE*3</FONT></FONT>
for some fixed-point operations, or even <FONT FACE="Courier, monospace"><FONT SIZE=2>BYTE*8</FONT></FONT>
to prevent overflow in operations.</P>
<a name="#0.0.5.3 SBYTE[*cexpr]|outline""><H2 CLASS="western">5.3 SBYTE[*cexpr]</H2>
<P>A single or multi-byte signed variable. <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr</FONT></FONT>,
if present, sets the width (in BYTEs). Again JALv2 has two useful
aliases, <FONT FACE="Courier, monospace"><FONT SIZE=2>SWORD</FONT></FONT>
which is <FONT FACE="Courier, monospace"><FONT SIZE=2>SBYTE*2</FONT></FONT>,
and <FONT FACE="Courier, monospace"><FONT SIZE=2>SDWORD</FONT></FONT>
which is <FONT FACE="Courier, monospace"><FONT SIZE=2>SBYTE*4</FONT></FONT>.</P>
<a name="#0.0.5.4 Universal|outline""><H2 CLASS="western">5.4 Universal</H2>
<P>The <FONT FACE="Courier, monospace"><FONT SIZE=2>UNIVERSAL</FONT></FONT>
type is the type assumed for unnamed constants and literals.
Internally, it is 32 bits wide, either signed or unsigned. When used
in an operation with another type, the result is that of the other
operand. In the event that the <FONT FACE="Courier, monospace"><FONT SIZE=2>UNIVERSAL</FONT></FONT>
constant will not fit within the other operand and warning will be
generated.</P>
<a name="#0.6. Constants|outline"><H1 CLASS="western">6. Constants</H1>
<a name="#0.0.6.1 Literal|outline""><H2 CLASS="western">6.1 Literal</H2>
<P>A literal constant is simply a number. It has the <FONT FACE="Courier, monospace"><FONT SIZE=2>UNIVERSAL</FONT></FONT>
type. By default, literal constants are assumed to be decimal, but
this can be overridden with the following prefixes:</P>
<P><FONT FACE="Courier, monospace"><FONT SIZE=2>0b...</FONT></FONT> ;
defines a binary constant</P>
<P><FONT FACE="Courier, monospace"><FONT SIZE=2>0q...</FONT></FONT> ;
defines an octal constant</P>
<P><FONT FACE="Courier, monospace"><FONT SIZE=2>0x...</FONT></FONT> ;
defines a hexidecimal constant</P>
<P>After the prefix, the underscore character can be used to group
the digits, for example:</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Courier, monospace"><FONT SIZE=2>0b0000_1111_0011_1100</FONT></FONT></P>
<P>any underscores are ignored.</P>
<P>&ldquo;<FONT FACE="Courier, monospace"><FONT SIZE=2>x&rdquo;</FONT></FONT>
   ; defines a character constants. The result is the ASCII value of
the character</P>
<P>&ldquo;<FONT FACE="Courier New, monospace"><FONT SIZE=2>xyz&rdquo;<FONT FACE="Times New Roman, serif"><FONT SIZE=3>;
defines a character string. The result is a universal array, with
each element representing a single character.</FONT></FONT></FONT></FONT></P>
<P><FONT FACE="Courier New, monospace"><FONT SIZE=2>{ cexpr1, cexpr2,
... }<FONT FACE="Times New Roman, serif"><FONT SIZE=3> ; defines a
universal array.</FONT></FONT></FONT></FONT></P>
<a name="#0.0.6.2 Named|outline""><H2 CLASS="western">6.2 Named</H2>
<P>Syntax:</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Courier, monospace"><FONT SIZE=2>CONST
[type] identifier1 &ldquo;=&rdquo; cexpr1[, identifier2 &ldquo;=&rdquo;
cexpr2...]</FONT></FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Courier, monospace"><FONT SIZE=2>CONST
[type] identifier1&quot;[&quot; [cexpr] &quot;]&quot; &quot;=&quot;
&quot;{&quot; cexpr1[, cexpr2...] &quot;}&quot;</FONT></FONT></P>
<P>If <FONT FACE="Courier, monospace"><FONT SIZE=2>[type]</FONT></FONT>
is present, the identifier will be of that type, otherwise it will be
<FONT FACE="Courier, monospace"><FONT SIZE=2>UNIVERSAL</FONT></FONT>.
The value identifier marked <FONT FACE="Courier, monospace"><FONT SIZE=2>CONST</FONT></FONT>
will retain the same throughout its life.</P>
<P>In the second form, an array of values is created. If <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr</FONT></FONT>
is present, it must be greater than zero and the number of
initializers must match the value of <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr</FONT></FONT>.
If it is not present, it's value is derived from the number of
initializers. To access an element of a constant array, use bracket
notation: <FONT FACE="Courier, monospace"><FONT SIZE=2>x[5]</FONT></FONT>
or <FONT FACE="Courier, monospace"><FONT SIZE=2>x[ii]</FONT></FONT>.
Array elements are numbered 0 through <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr
- 1</FONT></FONT>. A constant array is limited by available program
space in the destination device.</P>
<a name="#0.7. Variables|outline"><H1 CLASS="western">7. Variables</H1>
<P>Syntax:</P>
<P STYLE="margin-left: 0.5in"><FONT FACE="Courier, monospace"><FONT SIZE=2>VAR
[VOLATILE] <I>type</I> identifier[ [&quot;[&quot; cexpr &quot;]&quot;]
] [ &ldquo;=&rdquo; expr1 ][, identifier2 [&ldquo;=&rdquo; expr2]...]</FONT></FONT></P>
<P>Variables are much like named constants, except their values can
change throughout the life of a program, and their types must be
explicitly set. <FONT FACE="Courier, monospace"><FONT SIZE=2>type</FONT></FONT>
is one of: <FONT FACE="Courier, monospace"><FONT SIZE=2>BIT</FONT></FONT>,
<FONT FACE="Courier, monospace"><FONT SIZE=2>BYTE[*cexpr]</FONT></FONT>,
<FONT FACE="Courier, monospace"><FONT SIZE=2>SBYTE[*cexpr]</FONT></FONT>,
<FONT FACE="Courier, monospace"><FONT SIZE=2>WORD</FONT></FONT>,
<FONT FACE="Courier, monospace"><FONT SIZE=2>SWORD</FONT></FONT>,
<FONT FACE="Courier, monospace"><FONT SIZE=2>DWORD</FONT></FONT>, or
<FONT FACE="Courier, monospace"><FONT SIZE=2>SDWORD</FONT></FONT>.
The <FONT FACE="Courier, monospace"><FONT SIZE=2>VOLATILE</FONT></FONT>
keyword, if present, guarantees the following:</P>
<UL>
        <LI><P>operations <FONT FACE="Courier, monospace"><FONT SIZE=2>identifier</FONT></FONT>
        will always occur (not be optimized away)</P>
        <LI><P>in any expression, <FONT FACE="Courier, monospace"><FONT SIZE=2>identifier</FONT></FONT>
        will only be evaluated once</P>
        <LI><P>in any expression, <FONT FACE="Courier, monospace"><FONT SIZE=2>identifier</FONT></FONT>
        will only be assigned once</P>
        <LI><P><FONT FACE="Courier, monospace"><FONT SIZE=2>identifier </FONT></FONT>will
        not ever hold a partial result</P>
</UL>
<P>If <FONT FACE="Courier, monospace"><FONT SIZE=2>&quot;[&quot;
cexpr &quot;]&quot;</FONT></FONT> is present, <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr</FONT></FONT>
must be a value greater than 0. This defines an array of values. To
access any element in the array, one uses brackets, as in : <FONT FACE="Courier, monospace"><FONT SIZE=2>x[5]</FONT></FONT>
or <FONT FACE="Courier, monospace"><FONT SIZE=2>x[y]</FONT></FONT>.
Array elements begin with index 0 and continue through <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr
- 1</FONT></FONT>. The array size is limited to largest available
data space. Arrays, like all variable types, must fit within a single
data bank.</P>
<P>Normally, the compiler determines where each variable is placed,
but it is often useful for variables to be placed at specific
locations (for example, to take advantage of the special function
registers of the PIC). This is accomplished using the AT clause:</P>
<P STYLE="margin-left: 0.5in"><FONT FACE="Courier, monospace"><FONT SIZE=2>VAR
[VOLATILE] type identifier AT { cexpr1 | var } [&ldquo;:&rdquo;
cexpr2] [&ldquo;=&rdquo; ...]</FONT></FONT></P>
<P>This will place <FONT FACE="Courier, monospace"><FONT SIZE=2>identifier</FONT></FONT>
at absolute location <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr1</FONT></FONT>,
or will share the location of <FONT FACE="Courier, monospace"><FONT SIZE=2>var</FONT></FONT>.
If type is <FONT FACE="Courier, monospace"><FONT SIZE=2>BIT</FONT></FONT>,
the variable can optionally be placed at an absolute bit position at
the location. Note that a variable <B>must</B> fit entirely within a
data page. For example, putting a <FONT FACE="Courier, monospace"><FONT SIZE=2>WORD</FONT></FONT>
variable at location <FONT FACE="Courier, monospace"><FONT SIZE=2>0x7f</FONT></FONT>
will lead to undefined behaviour.</P>
<P>Sometimes it is useful for a variable to be renamed. To create an
alias, the syntax is:</P>
<P STYLE="margin-left: 0.5in"><FONT FACE="Courier, monospace"><FONT SIZE=2>VAR
[VOLATILE] type identifier1 IS identifier2</FONT></FONT></P>
<a name="#0.8. Expressions|outline"><H1 CLASS="western">8. Expressions</H1>
<P>Now that we have variables and constants, it's time to create
expressions. An expression is simply value (variables or constants)
and operators. The operators of JALv2 are:</P>
<TABLE WIDTH=100% BORDER=1 CELLPADDING=4 CELLSPACING=3>
        <COL WIDTH=26*>
        <COL WIDTH=102*>
        <COL WIDTH=128*>
        <THEAD>
                <TR VALIGN=TOP>
                        <TH WIDTH=10%>
                                <P>Operator</P>
                        </TH>
                        <TH WIDTH=40%>
                                <P>Operation</P>
                        </TH>
                        <TH WIDTH=50%>
                                <P>Result</P>
                        </TH>
                </TR>
        </THEAD>
        <TBODY>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>count</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>returns the number of elements in an array</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>UNIVERAL</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>whereis</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>returns the location of an identifier</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>UNIVERSAL</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>defined</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>determines if an identifier exists</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>UNIVERAL</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>-</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Unary &ndash; (negation)</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>Same as operand</P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>!</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>1's complement</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>Same as operand</P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>!!</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Logical</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>BIT</P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>+</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Unary + (no operation)</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>Same as operand</P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>*</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Multiplication</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>Promotion<SUP>2</SUP></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>/</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Division</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>Promotion<SUP>2</SUP></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>%</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Modulus division (remainder)</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>Promotion<SUP>2</SUP></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>+</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Addition</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>Promotion<SUP>2</SUP></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>-</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Subtraction</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>Promotion<SUP>2</SUP></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>&lt;&lt;</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Shift left</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>Promotion<SUP>2</SUP></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>&gt;&gt;<SUP>1</SUP></P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Shift right</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>Promotion<SUP>2</SUP></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>&lt;</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Less than</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>BIT</P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>&lt;=</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Less or Equal</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>BIT</P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>&ldquo;==&rdquo;</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Equality</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>BIT</P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>!=</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Unequal</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>BIT</P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>&gt;=</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Greater or Equal</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>BIT</P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>&gt;</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Greater Than</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>BIT</P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>&amp;</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Binary AND</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>Promotion<SUP>2</SUP></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>|</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Binary OR</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>Promotion<SUP>2</SUP></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=10%>
                                <P ALIGN=CENTER>^</P>
                        </TD>
                        <TD WIDTH=40%>
                                <P>Binary Exclusive OR</P>
                        </TD>
                        <TD WIDTH=50%>
                                <P>Promotion<SUP>2</SUP></P>
                        </TD>
                </TR>
        </TBODY>
</TABLE>
<P><SUP>1 </SUP>shift right: If the left operand is signed the shift
is arithmetic (sign preserving). If unsigned, it is logical.</P>
<P><SUP>2</SUP> promotion: The promotion rules are tricky, here are
the cases:</P>
<P>If one of the operands is <FONT FACE="Courier, monospace"><FONT SIZE=2>UNIVERSAL</FONT></FONT>
and the other is not, the result is same as the non-<FONT FACE="Courier, monospace"><FONT SIZE=2>UNIVERSAL</FONT></FONT>
operand.</P>
<P>If both operands have the same signedness and width, the result is
that of the operands.</P>
<P>If both operands are the same width, and one is unsigned, the
result is unsigned.</P>
<P>If one operand is wider than the other, the other operand will be
promoted to the wider type.</P>
<a name="#0.9. Flow Control|outline"><H1 CLASS="western">9. Flow Control</H1>
<a name="#0.0.9.1 BLOCK|outline""><H2 CLASS="western">9.1 BLOCK</H2>
<P STYLE="margin-bottom: 0in">Syntax:</P>
<P STYLE="margin-left: 0.5in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>BLOCK</FONT></FONT></P>
<P STYLE="margin-left: 0.7in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT></P>
<P STYLE="margin-left: 0.5in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>END
BLOCK</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">This simply creates a new block. Any
variables defined in this block go out of scope at the block. Mainly
useful with the <FONT FACE="Courier, monospace"><FONT SIZE=2>CASE</FONT></FONT>
statement (below).</P>
<a name="#0.0.9.2 CASE|outline""><H2 CLASS="western">9.2 CASE</H2>
<P STYLE="margin-bottom: 0in">Syntax:</P>
<P STYLE="margin-left: 0.51in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>CASE
expr OF</FONT></FONT></P>
<P STYLE="margin-left: 0.51in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr1[,
cexpr1a...] &ldquo;:&rdquo; statement</FONT></FONT></P>
<P STYLE="margin-left: 0.51in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>[
cexpr2 &ldquo;:&rdquo; statement ]</FONT></FONT></P>
<P STYLE="margin-left: 0.51in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>...</FONT></FONT></P>
<P STYLE="margin-left: 0.51in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>[
OTHERWISE statement ]</FONT></FONT></P>
<P STYLE="margin-left: 0.51in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>END
CASE</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>expr</FONT></FONT>
is evaluated and compared against each <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr</FONT></FONT>
listed. If a match occurs, the statement to the right of the matching
<FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr</FONT></FONT> is
executed. If no match occurs, the statement after <FONT FACE="Courier, monospace"><FONT SIZE=2>OTHERWISE</FONT></FONT>
is executed. If there is no <FONT FACE="Courier, monospace"><FONT SIZE=2>OTHERWISE</FONT></FONT>,
control continues after <FONT FACE="Courier, monospace"><FONT SIZE=2>END
CASE</FONT></FONT>. Unlike Pascal, the behaviour is completely
defined if there is no matching expression.</P>
<P STYLE="margin-bottom: 0in">Unlike C (but like Pascal) there is no
explicit break. After a statement is processed, control proceeds past
the <FONT FACE="Courier, monospace"><FONT SIZE=2>END CASE.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">Each <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr</FONT></FONT>
must evaluate to a unique value.</P>
<a name="#0.0.9.3 FOR|outline""><H2 CLASS="western">9.3 FOR</H2>
<P>Syntax:</P>
<P STYLE="margin-left: 0.5in"><FONT FACE="Courier, monospace"><FONT SIZE=2>FOR
expr [USING var] LOOP</FONT></FONT></P>
<P STYLE="margin-left: 0.7in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT></P>
<P STYLE="margin-left: 0.7in"><FONT FACE="Courier, monospace"><FONT SIZE=2>[exit
loop]</FONT></FONT></P>
<P STYLE="margin-left: 0.5in"><FONT FACE="Courier, monospace"><FONT SIZE=2>END
LOOP</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT> is executed <FONT FACE="Courier, monospace"><FONT SIZE=2>expr</FONT></FONT>
times. If <FONT FACE="Courier, monospace"><FONT SIZE=2>USING var</FONT></FONT>
is defined, the index is kept in <FONT FACE="Courier, monospace"><FONT SIZE=2>var</FONT></FONT>,
beginning with zero and incrementing to <FONT FACE="Courier, monospace"><FONT SIZE=2>expr</FONT></FONT>.
If <FONT FACE="Courier, monospace"><FONT SIZE=2>var</FONT></FONT> is
not large enough to hold <FONT FACE="Courier, monospace"><FONT SIZE=2>expr</FONT></FONT>,
a warning is generated. If <FONT FACE="Courier New, monospace"><FONT SIZE=2>[exit
loop]</FONT></FONT> is used, the loop is immediately exited.</P>
<a name="#0.0.9.4 FOREVER|outline""><H2 CLASS="western">9.4 FOREVER</H2>
<P>Syntax:</P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>FOREVER
LOOP</FONT></FONT></P>
<P STYLE="margin-left: 0.71in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT></P>
<P STYLE="margin-left: 0.71in"><FONT FACE="Courier, monospace"><FONT SIZE=2>[exit
loop]</FONT></FONT></P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>END
LOOP</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT> is executed forever unless <FONT FACE="Courier, monospace"><FONT SIZE=2>[exit
loop]</FONT></FONT> is encountered, in which case the loop is
immediately terminated.. This is commonly used for the main loop in a
program because an embedded program like this never ends.</P>
<a name="#0.0.9.5 IF|outline""><H2 CLASS="western">9.5 IF</H2>
<P>Syntax:</P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>IF
expr THEN</FONT></FONT></P>
<P STYLE="margin-left: 0.69in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT></P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>[ELSIF
expr2 THEN</FONT></FONT></P>
<P STYLE="margin-left: 0.69in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block]</FONT></FONT></P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>[ELSE</FONT></FONT></P>
<P STYLE="margin-left: 0.7in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block]</FONT></FONT></P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>END
IF</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">This creates a test, or series of
tests. The <FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT> under the first <FONT FACE="Courier, monospace"><FONT SIZE=2>expr</FONT></FONT>
that evaluates to a non-zero value will be executed. Any number of
<FONT FACE="Courier, monospace"><FONT SIZE=2>ELSIF</FONT></FONT>
clauses are allowed. If no <FONT FACE="Courier, monospace"><FONT SIZE=2>expr</FONT></FONT>
evaluates to true and the <FONT FACE="Courier, monospace"><FONT SIZE=2>ELSE</FONT></FONT>
clause exists, the <FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT> for the <FONT FACE="Courier, monospace"><FONT SIZE=2>ELSE</FONT></FONT>
clause will be executed.</P>
<P STYLE="margin-bottom: 0in">A special case of the <FONT FACE="Courier, monospace"><FONT SIZE=2>IF</FONT></FONT>
statement is when any <FONT FACE="Courier, monospace"><FONT SIZE=2>expr</FONT></FONT>
is a constant. In this case, the <FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT> is not parsed. This can be used for block
comments.</P>
<P STYLE="margin-left: 0.52in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>IF
0</FONT></FONT></P>
<P STYLE="margin-left: 0.52in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>this
is a dummy block that won't even be parsed!</FONT></FONT></P>
<P STYLE="margin-left: 0.52in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>END
IF</FONT></FONT></P>
<a name="#0.0.9.6 REPEAT|outline""><H2 CLASS="western">9.6 REPEAT</H2>
<P STYLE="margin-bottom: 0in">Syntax:</P>
<P STYLE="margin-left: 0.51in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>REPEAT</FONT></FONT></P>
<P STYLE="margin-left: 0.7in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT></P>
<P STYLE="margin-left: 0.51in; margin-bottom: 0in">  <FONT FACE="Courier, monospace"><FONT SIZE=2>[exit
loop]<BR>UNTIL expr</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT> will be executed until <FONT FACE="Courier, monospace"><FONT SIZE=2>expr</FONT></FONT>
evaluates to a non-zero value, or until <FONT FACE="Courier, monospace"><FONT SIZE=2>[exit
loop] </FONT></FONT>is encountered.</P>
<a name="#0.0.9.7 WHILE|outline""><H2 CLASS="western">9.7 WHILE</H2>
<P STYLE="margin-bottom: 0in">Syntax:</P>
<P STYLE="margin-left: 0.51in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>WHILE
expr LOOP</FONT></FONT></P>
<P STYLE="margin-left: 0.7in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT></P>
<P STYLE="margin-left: 0.51in; margin-bottom: 0in">  <FONT FACE="Courier, monospace"><FONT SIZE=2>[exit
loop]<BR>END LOOP</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT> will be executed as long as <FONT FACE="Courier, monospace"><FONT SIZE=2>expr</FONT></FONT>
evaluates to a non-zero value, or until <FONT FACE="Courier, monospace"><FONT SIZE=2>[exit
loop] </FONT></FONT>is encountered. This is similar to <FONT FACE="Courier New, monospace"><FONT SIZE=2>REPEAT</FONT></FONT>
above, the difference being the <FONT FACE="Courier New, monospace"><FONT SIZE=2>statement
block</FONT></FONT> of <FONT FACE="Courier New, monospace"><FONT SIZE=2>REPEAT</FONT></FONT>
loop will always execute at least once, whereas a that of a <FONT FACE="Courier New, monospace"><FONT SIZE=2>WHILE</FONT></FONT>
loop may never execute.</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<a name="#0.10. Sub-programs : Procedures and Functions|outline""><H1 CLASS="western">10. Sub-programs : Procedures and Functions</H1>
<P>Syntax:</P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>PROCEDURE
identifier [ &ldquo;(&ldquo; [VOLATILE] type { IN | OUT | IN OUT }
identifier2 [, ...] &ldquo;)&rdquo; IS</FONT></FONT></P>
<P STYLE="margin-left: 0.71in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT></P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>END
PROCEDUREs</FONT></FONT></P>
<P STYLE="margin-left: 0.51in"><BR><BR>
</P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>FUNCTION
identifier [ &ldquo;(&ldquo; [VOLATILE] type { IN | OUT | IN OUT }
identifier2 [, ...] &ldquo;)&rdquo; RETURN type IS</FONT></FONT></P>
<P STYLE="margin-left: 0.7in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT></P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>END
FUNCTION</FONT></FONT></P>
<P>The only difference between a <FONT FACE="Courier, monospace"><FONT SIZE=2>PROCEDURE</FONT></FONT>
and a <FONT FACE="Courier, monospace"><FONT SIZE=2>FUNCTION</FONT></FONT>,
is the former does not return a value, while the later does. The
procedure identifier exists in the block in which the procedure is
defined. A new block is immediately opened, and all parameters exist
in that block. A parameter marked <FONT FACE="Courier, monospace"><FONT SIZE=2>IN</FONT></FONT>
will be assigned the value passed when called. A parameter marked <FONT FACE="Courier, monospace"><FONT SIZE=2>OUT</FONT></FONT>
will assign the resulting value to parameter passed when called.
While in a sub-program, a new keyword is introduced:</P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>RETURN
[expr]</FONT></FONT></P>
<P>When executed, the sub program immediately returns. If the sub
program is a <FONT FACE="Courier, monospace"><FONT SIZE=2>FUNCTION</FONT></FONT>,
<FONT FACE="Courier, monospace"><FONT SIZE=2>expr</FONT></FONT> is
required. If it is a <FONT FACE="Courier, monospace"><FONT SIZE=2>PROCEDURE</FONT></FONT>,
<FONT FACE="Courier, monospace"><FONT SIZE=2>expr</FONT></FONT> is
forbidden.</P>
<P>A sub-program is executed simply by using its name. If parameters
are specified in the sub-program definition, all parameters are
required, otherwise none are allowed. A <FONT FACE="Courier, monospace"><FONT SIZE=2>FUNCTION</FONT></FONT>
can be used anywhere a value is required (in expressions, as
parameters to other sub-programs, etc). There is no limit to the
number of parameters.</P>
<P>JAL is a pass by value language. Conceptually, an <FONT FACE="Courier, monospace"><FONT SIZE=2>IN</FONT></FONT>
parameter is read once when the sub-program enters, and an <FONT FACE="Courier, monospace"><FONT SIZE=2>OUT</FONT></FONT>
parameters is written once when the sub-program returns. This is not
always desired. For example if a sub-program writes a string of
characters to the serial port (passed as parameter), only the last
character written will be sent. For this case we need <FONT FACE="Courier, monospace"><FONT SIZE=2>VOLATILE</FONT></FONT>
parameters. These are either read each time used (<FONT FACE="Courier, monospace"><FONT SIZE=2>IN</FONT></FONT>)
or written each time assigned (<FONT FACE="Courier, monospace"><FONT SIZE=2>OUT</FONT></FONT>).
This is accomplished using pseudo variables (see below). If the value
passed is not a pseudo-variable, a suitable one is created.</P>
<P>Procedures and functions can be nested.</P>
<P>Example:</P>
<P STYLE="margin-left: 0.5in"><FONT FACE="Courier, monospace"><FONT SIZE=2>FUNCTION
square_root (WORD IN n) RETURN WORD IS</FONT></FONT></P>
<P STYLE="margin-left: 0.7in"><FONT FACE="Courier, monospace"><FONT SIZE=2>WORD
result</FONT></FONT></P>
<P STYLE="margin-left: 0.7in"><FONT FACE="Courier, monospace"><FONT SIZE=2>WORD
ix</FONT></FONT></P>
<P STYLE="margin-left: 0.7in"><FONT FACE="Courier, monospace"><FONT SIZE=2>ix
= 1</FONT></FONT></P>
<P STYLE="margin-left: 0.7in"><FONT FACE="Courier, monospace"><FONT SIZE=2>WHILE
ix &lt; n LOOP</FONT></FONT></P>
<P STYLE="margin-left: 0.9in"><FONT FACE="Courier, monospace"><FONT SIZE=2>n
= n &ndash; ix</FONT></FONT></P>
<P STYLE="margin-left: 0.9in"><FONT FACE="Courier, monospace"><FONT SIZE=2>result
= result + 1</FONT></FONT></P>
<P STYLE="margin-left: 0.9in"><FONT FACE="Courier, monospace"><FONT SIZE=2>ix
= ix + 2</FONT></FONT></P>
<P STYLE="margin-left: 0.71in"><FONT FACE="Courier, monospace"><FONT SIZE=2>END
WHILE</FONT></FONT></P>
<P STYLE="margin-left: 0.7in"><FONT FACE="Courier, monospace"><FONT SIZE=2>RETURN
result</FONT></FONT></P>
<P STYLE="margin-left: 0.5in"><FONT FACE="Courier, monospace"><FONT SIZE=2>END
FUNCTION</FONT></FONT></P>
<P STYLE="margin-left: 0.5in"><BR><BR>
</P>
<P STYLE="margin-left: 0.5in"><FONT FACE="Courier, monospace"><FONT SIZE=2>xx
= square_root(xx)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">Recursion is fully supported but due to
the overhead it is discouraged.</P>
<a name="#0.11. Pseudo-variables|outline""><H1 CLASS="western">11. Pseudo-variables</H1>
<P>Syntax:</P>
<P STYLE="margin-left: 0.5in"><FONT FACE="Courier, monospace"><FONT SIZE=2>PROCEDURE
identifier &ldquo;'&rdquo; PUT &ldquo;(&ldquo; type IN identifier2
&ldquo;)&rdquo; IS</FONT></FONT></P>
<P STYLE="margin-left: 0.7in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT></P>
<P STYLE="margin-left: 0.5in"><FONT FACE="Courier, monospace"><FONT SIZE=2>END
PROCEDURE</FONT></FONT></P>
<P STYLE="margin-left: 0.5in"><FONT FACE="Courier, monospace"><FONT SIZE=2>FUNCTION
identifier &ldquo;'&rdquo; GET RETURN type IS</FONT></FONT></P>
<P STYLE="margin-left: 0.7in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT></P>
<P STYLE="margin-left: 0.5in"><FONT FACE="Courier, monospace"><FONT SIZE=2>END
FUNCTION</FONT></FONT></P>
<P>A pseudo-variable is a sub-program, or pair of sub-programs that
work as if they are variables. If a 'PUT procedure is defined, any
assignment to the sub-program is actually a call to the 'PUT
procedure. Similarly, if a 'GET function is defined, any time the
associated value is used is an implicit call to the function.</P>
<P>If both a 'GET and 'PUT sub-program are defined, the parameter
type of the 'PUT must match the return type of the 'GET.</P>
<a name="#0.12. Interrupts|outline""><H1 CLASS="western">12. Interrupts</H1>
<P>Syntax:</P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>PROCEDURE
identifier IS</FONT></FONT></P>
<P STYLE="margin-left: 0.7in"><FONT FACE="Courier, monospace"><FONT SIZE=2>PRAGMA
INTERRUPT [FAST]</FONT></FONT></P>
<P STYLE="margin-left: 0.7in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT></P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>END
PROCEDURE</FONT></FONT></P>
<P><BR><BR>
</P>
<P><FONT FACE="Courier, monospace"><FONT SIZE=2>PRAGMA INTERRUPT</FONT></FONT>
tells JAL that this procedure can only be called by the
microcontroller's interrupt processing. Any number of procedures can
be defined as an interrupt handler. When an interrupt occurs, first
the microprocessor state is saved, then control passes to the first
procedure marked as an interrupt handler. Control continues to pass
to each interrupt handler until the last, then the microprocessor
state is restored and the interrupt ended. The programmer is
responsible for clearing whatever bits caused the interrupt to
happen. A procedure marked as an interrupt handler cannot be called
directly from elsewhere in the program. Beyond that, an interrupt
handler can do anything any other procedure can do. The order the
interrupt handlers are called is undefined, the only guarantee is
each handler will be called at each interrupt, and will only be
called once.</P>
<P>If an interrupt handler executes a sub-program that is also
executed by the main body of the program, that sub-program will be
marked recursive and incur the recursion overhead each time it is
called.</P>
<P>If <FONT FACE="Courier, monospace"><FONT SIZE=2>FAST</FONT></FONT>
is declared, the interrupt handler will only save the minimum amount
of state necessary. This must be used with great care &ndash;
although the microprocessor state is saved, state used internally by
the compiler is not. As such, only a completely assembly sub-program
should be used. Any JAL statements might invalidate the internal
state of the compiler. If any interrupt handler is marked <FONT FACE="Courier, monospace"><FONT SIZE=2>FAST</FONT></FONT>
then only one interrupt handler is allowed.</P>
<a name="#0.13. Tasks|outline""><H1 CLASS="western">13. Tasks</H1>
<P>Syntax:</P>
<P STYLE="margin-left: 0.5in"><FONT FACE="Courier, monospace"><FONT SIZE=2>TASK
identifier [ &ldquo;(&ldquo; parameter list &ldquo;)&rdquo; ] IS</FONT></FONT></P>
<P STYLE="margin-left: 0.68in"><FONT FACE="Courier, monospace"><FONT SIZE=2>statement
block</FONT></FONT></P>
<P STYLE="margin-left: 0.5in"><FONT FACE="Courier, monospace"><FONT SIZE=2>END
TASK</FONT></FONT></P>
<P><BR><BR>
</P>
<P>JALv2 introduces the concept of tasks which are a form of
co-operative multi-tasking. Unlike preemptive multi-tasking, where
control passes from one task to another automatically, control will
only pass when a task specifically allows it. Due to the architecture
of a PIC, true multi-tasking is very difficult. Tasks can only be
started by the main program, or within another task. Tasks are
started with:</P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>START
identifier [ &ldquo;(&ldquo; parameter list &ldquo;)&rdquo; ]</FONT></FONT></P>
<P>When a task is ready to allow another to run, it executes:</P>
<P STYLE="margin-left: 0.5in"><FONT FACE="Courier, monospace"><FONT SIZE=2>SUSPEND</FONT></FONT></P>
<P>To end the task, simply <FONT FACE="Courier, monospace"><FONT SIZE=2>RETURN</FONT></FONT>
or allow the control to pass to the end of the task. If tasks are
used, the compiler must be passed the argument, &ldquo;-task n,&rdquo;
where n is the number of concurrent running tasks. Remember that the
main program itself is a task, so if you plan to run the main program
plus two tasks, you'll need to pass in, &ldquo;-task 3&rdquo;.</P>
<P>Finally, only one copy of the body of a task should be run at a
time. The following would be an error because it attempts to run two
copies of task1 at the same time:</P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>START
task1</FONT></FONT></P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>START
task1</FONT></FONT></P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>FOREVER
LOOP</FONT></FONT></P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>SUSPEND</FONT></FONT></P>
<P STYLE="margin-left: 0.51in"><FONT FACE="Courier, monospace"><FONT SIZE=2>END
LOOP</FONT></FONT></P>
<P><BR><BR>
</P>
<a name="#0.14. Assembly|outline""><H1 CLASS="western">14. Assembly</H1>
<P STYLE="margin-bottom: 0in">Finally, when all else fails, one can
resort to in-line assembly. This can be in the form of a single
statement:</P>
<P STYLE="margin-left: 0.51in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>asm
...</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">or an entire block:</P>
<P STYLE="margin-left: 0.5in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>assembler</FONT></FONT></P>
<P STYLE="margin-left: 0.69in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>...</FONT></FONT></P>
<P STYLE="margin-left: 0.5in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>end
assembler</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Using
assembly should be a last resort &ndash; it is needed only when
either a feature is not possible using JAL (for example, the TRIS and
OPTION codes), or when speed is of the essence. JALv2 includes the
entire assembly language set in the PIC16F87x data sheet, several
instructions from earlier micro controllers, and several common
macros.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>To
guarantee the correct data bank is selected when accessing a file
register, use one of the following:</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.51in; margin-bottom: 0in; font-weight: medium">
<FONT FACE="Courier, monospace"><FONT SIZE=2>bank opcode...</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>or</FONT></FONT></P>
<P STYLE="margin-left: 0.5in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>bank
f</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>the
former takes the file register from the command, the later takes it
directly.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Similarly,
to guarantee the correct page bits are set (for goto or call), use
one of the following:</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.5in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>page
opcode ...</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>or</FONT></FONT></P>
<P STYLE="margin-left: 0.5in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>page
lbl</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Again,
the former takes the label from the command, the later takes it
directly.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Normally,
the codes to set or clear the bank or page bits are only generated
when necessary. If the correct bits are already in the correct
states, no further commands are generated. If you need to guarantee
the codes are always generated, use the following pragmas:</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.5in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>pragma
keep page</FONT></FONT></P>
<P STYLE="margin-left: 0.5in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>pragma
keep bank</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>The
former will keep any page bits, the later and bank bits. These affect
the entire sub-program in which they are declared.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>To
declare a local label for use in calls and/or gotos:</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.5in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>local
identifier1[, identifier 2...]</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Once
declared, a label is inserted into the assembly block by making it
the first part of a statement, followed by a ':':</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.52in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>identifier:
opcode...</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>The
available opcodes are listed below. For a full description see the
appropriate data sheet.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<TABLE WIDTH=100% BORDER=1 CELLPADDING=4 CELLSPACING=3>
        <COL WIDTH=43*>
        <COL WIDTH=43*>
        <COL WIDTH=43*>
        <COL WIDTH=43*>
        <COL WIDTH=43*>
        <COL WIDTH=43*>
        <TR VALIGN=TOP>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>addwf f, d</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>andwf f, d</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>clrf f</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>clrw</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>comf f, d</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>decf f, d</FONT></FONT></P>
                </TD>
        </TR>
        <TR VALIGN=TOP>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>decfsz f, d</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>incf f, d</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>incfsz f, d</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>iorwf f, d</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>movf f, d</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>movwf</FONT></FONT></P>
                </TD>
        </TR>
        <TR VALIGN=TOP>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>nop</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>rlf f, d</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>rrf f, d</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>subwf f, d</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>swapf f, d</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>xorwf f, d</FONT></FONT></P>
                </TD>
        </TR>
        <TR VALIGN=TOP>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>bcf f, b</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>bsf f, b</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btfsc f, b</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btfss f, b</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><BR>
                        </P>
                </TD>
                <TD WIDTH=17%>
                        <P><BR>
                        </P>
                </TD>
        </TR>
        <TR VALIGN=TOP>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>addlw k</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>andlw k</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>call l</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>clrwdt</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>goto l</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>iorlw k</FONT></FONT></P>
                </TD>
        </TR>
        <TR VALIGN=TOP>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>movlw k</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>retfie</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>retlw k</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>return</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>sleep</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>sublw k</FONT></FONT></P>
                </TD>
        </TR>
        <TR VALIGN=TOP>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>xorlw k</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>option<SUP>1</SUP></FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>tris<SUP>2</SUP> t</FONT></FONT></P>
                </TD>
                <TD WIDTH=17%>
                        <P><BR>
                        </P>
                </TD>
                <TD WIDTH=17%>
                        <P><BR>
                        </P>
                </TD>
                <TD WIDTH=17%>
                        <P><BR>
                        </P>
                </TD>
        </TR>
</TABLE>
<P STYLE="margin-bottom: 0in"><SUP><FONT FACE="Times New Roman, serif">1</FONT></SUP>
<FONT FACE="Courier, monospace"><FONT SIZE=2>option</FONT></FONT>
<FONT FACE="Times New Roman, serif">moves the contents of </FONT><FONT FACE="Courier, monospace"><FONT SIZE=2>W</FONT></FONT>
<FONT FACE="Times New Roman, serif">into the </FONT><FONT FACE="Courier, monospace"><FONT SIZE=2>OPTION</FONT></FONT>
<FONT FACE="Times New Roman, serif">register. It is deprecated on
microcontrollers that have </FONT><FONT FACE="Courier, monospace"><FONT SIZE=2>OPTION</FONT></FONT>
<FONT FACE="Times New Roman, serif">mapped into the special function
registers.</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SUP>2</SUP>
<FONT FACE="Courier, monospace"><FONT SIZE=2>tris</FONT></FONT> moves
the contents of <FONT FACE="Courier, monospace"><FONT SIZE=2>W</FONT></FONT>
into the specified <FONT FACE="Courier, monospace"><FONT SIZE=2>TRIS</FONT></FONT>
register. It is deprecated on microcontrollers that have the <FONT FACE="Courier, monospace"><FONT SIZE=2>TRISx</FONT></FONT>
registers mapped into the special function registers.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><FONT FACE="Courier, monospace"><FONT SIZE=2>f</FONT></FONT>
- a file register, this can be a variable name or a number</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><FONT FACE="Courier, monospace"><FONT SIZE=2>d</FONT></FONT>
- destination, must evaluate to 0 (result in <FONT FACE="Courier, monospace"><FONT SIZE=2>W</FONT></FONT>),
or 1 (result in f)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><FONT FACE="Courier, monospace"><FONT SIZE=2>k</FONT></FONT>
- a constant between 0 and 255</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><FONT FACE="Courier, monospace"><FONT SIZE=2>t</FONT></FONT>
- a constant 5, 6 or 7</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><FONT FACE="Courier, monospace"><FONT SIZE=2>b</FONT></FONT>
- a constant 0 - 7</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><FONT FACE="Courier, monospace"><FONT SIZE=2>l</FONT></FONT>
- a label</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>In
addition to the real opcode, the following common pseudo-ops are also
available:</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<TABLE WIDTH=381 BORDER=1 CELLPADDING=4 CELLSPACING=3>
        <COL WIDTH=87>
        <COL WIDTH=267>
        <THEAD>
                <TR VALIGN=TOP>
                        <TH WIDTH=87>
                                <P>opcode</P>
                        </TH>
                        <TH WIDTH=267>
                                <P>description</P>
                        </TH>
                </TR>
        </THEAD>
        <TBODY>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>addcf f, d</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btfsc _status, _c
                                ; incf f, d</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>adddcf f, d</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btfsc _status,
                                _dc ; incf f, d</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>b l</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>goto l</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>bc l</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btfsc _status, _c
                                ; goto l</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>bdc l</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btfsc _status,
                                _dc ; goto l</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>bnc l</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btfss _status, _c
                                ; goto l</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>bndc l</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btfss _status,
                                _dc ; goto l</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>bnz l</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btfss _status, _z
                                ; goto l</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>bz l </FONT></FONT>
                                </P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btfsc _status, _z
                                ; goto l</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>clrc</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>bcf _status, _c</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>clrdc</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>bcf _status, _dc</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>clrz</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>bcf _status, _z</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>lcall l</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>page call l</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>lgoto l</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>page goto l</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>movfw f</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>movf f, w</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>negf, d</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>comf f, f ; incf
                                f, f</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>setc</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>bsf _status, _c</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>setdc</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>bsf _status, _dc</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>setz</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>bsf _status, _z</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>skpc</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btfss _status, _c</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>skpdc</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btfss _status,
                                _dc</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>skpnc</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btfsc _status, _c</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>skpndc</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btfsc _status,
                                _dc</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>skpnz</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btfsc _status, _z</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>skpz</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btfss _status, _z</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>subcf f, d</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btfsc _status, _c
                                ; decf f, d</FONT></FONT></P>
                        </TD>
                </TR>
                <TR VALIGN=TOP>
                        <TD WIDTH=87>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>subdcf f, d</FONT></FONT></P>
                        </TD>
                        <TD WIDTH=267>
                                <P><FONT FACE="Courier, monospace"><FONT SIZE=2>btrfsc _status,
                                _dc ; decf f, d</FONT></FONT></P>
                        </TD>
                </TR>
        </TBODY>
</TABLE>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Finally,
the following can be used to define data:</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<TABLE WIDTH=100% BORDER=1 CELLPADDING=4 CELLSPACING=3>
        <COL WIDTH=70*>
        <COL WIDTH=186*>
        <TR VALIGN=TOP>
                <TD WIDTH=27%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>db cexpr1,
                        cexpr2[, cexpr3, cexpr4...]</FONT></FONT></P>
                </TD>
                <TD WIDTH=73%>
                        <P>Places values <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr1:cexpr2</FONT></FONT>...
                        directly into the code. <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr1</FONT></FONT>
                        is the MSB, and <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr2</FONT></FONT>
                        the LSB. On a 14 bit core, 0 &lt;= <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr1</FONT></FONT>
                        &lt; 64, 0 &lt;= <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr2</FONT></FONT>
                        &lt; 256.</P>
                </TD>
        </TR>
        <TR VALIGN=TOP>
                <TD WIDTH=27%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>db &quot;...&quot;</FONT></FONT></P>
                </TD>
                <TD WIDTH=73%>
                        <P>Place a string of values directly into the code. This is
                        analogous to:</P>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>db 0, &quot;a&quot;,
                        0, &quot;b&quot;, ...</FONT></FONT></P>
                </TD>
        </TR>
        <TR VALIGN=TOP>
                <TD WIDTH=27%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>dw cexpr1[,
                        cexpr2...]</FONT></FONT></P>
                </TD>
                <TD WIDTH=73%>
                        <P>As above, but each <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr</FONT></FONT>
                        is placed in the program flash as a word. On a 14 bit core, 0 &lt;=
                        <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr</FONT></FONT> &lt;
                        16384</P>
                </TD>
        </TR>
        <TR VALIGN=TOP>
                <TD WIDTH=27%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>dw &quot;...&quot;</FONT></FONT></P>
                </TD>
                <TD WIDTH=73%>
                        <P>Place a string directly into the code. This is the same as `<FONT FACE="Courier, monospace"><FONT SIZE=2>dw
                        &quot;a&quot;,&quot;b&quot;, &quot;c&quot;...</FONT></FONT>'</P>
                </TD>
        </TR>
        <TR VALIGN=TOP>
                <TD WIDTH=27%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>ds
                        cexpr1[,cexpr2...]</FONT></FONT></P>
                </TD>
                <TD WIDTH=73%>
                        <P>This packs two characters at a time into the code. 0 &lt;=
                        <FONT FACE="Courier, monospace"><FONT SIZE=2>cexpr</FONT></FONT> &lt;
                        128
                        </P>
                </TD>
        </TR>
        <TR VALIGN=TOP>
                <TD WIDTH=27%>
                        <P><FONT FACE="Courier, monospace"><FONT SIZE=2>ds &quot;...&quot;</FONT></FONT></P>
                </TD>
                <TD WIDTH=73%>
                        <P>As above, using string notation</P>
                </TD>
        </TR>
</TABLE>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Although
these put data directly into the code, one needs to create the
necessary functions to read the data (which is out of the scope of
this document).</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>An
example of using strings as above:</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.51in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>FUNCTION
string_entry_get(BYTE IN ix) RETURN BYTE is</FONT></FONT></P>
<P STYLE="margin-left: 0.7in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>ASM
local str_table, readit</FONT></FONT></P>
<P STYLE="margin-left: 0.7in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>ASM
GOTO readit</FONT></FONT></P>
<P STYLE="margin-left: 0.7in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>ASM
str_table: DB &quot;this is a test string&quot;</FONT></FONT></P>
<P STYLE="margin-left: 0.7in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>ASM
readit:</FONT></FONT></P>
<P STYLE="margin-left: 0.7in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>WORD
pos</FONT></FONT></P>
<P STYLE="margin-left: 0.7in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>BYTE
ch</FONT></FONT></P>
<P STYLE="margin-left: 0.7in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.7in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>pos
= WHEREIS(str_table) + IX</FONT></FONT></P>
<P STYLE="margin-left: 0.7in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>;</FONT></FONT></P>
<P STYLE="margin-left: 0.7in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>;
code to read program FLASH at pos into ch would follow</FONT></FONT></P>
<P STYLE="margin-left: 0.7in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>;</FONT></FONT></P>
<P STYLE="margin-left: 0.7in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>RETURN
ch</FONT></FONT></P>
<P STYLE="margin-left: 0.51in; margin-bottom: 0in"><FONT FACE="Courier, monospace"><FONT SIZE=2>END
FUNCTION</FONT></FONT></P>
<P STYLE="margin-left: 0.51in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
</BODY>
</HTML>
