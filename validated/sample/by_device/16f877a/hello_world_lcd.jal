-- Title: Hello world with an LCD
-- Author: Eur Van Andel, Copyright (c) 2008, all rights reserved.
-- Adapted-by:
-- Compiler: >=2.4g
-- 
-- This file is part of jallib (http://jallib.googlecode.com)
-- Released under the BSD license (http://www.opensource.org/licenses/bsd-license.php)
--
-- Description: this sample shows how to setup an LCD and writes
-- "Hello World" to the first line, using a string and the print library.
-- Line 3 and line 4 are used as well, but will work properly only on a 4x20 LCD
-- a counter is printed to show the running forever loop.
--

include 16f877a          

pragma target   CLOCK 20_000_000                  -- xtal frequency
pragma target   OSC   HS
pragma target   LVP disabled
pragma target   WDT disabled

enable_digital_io()


var bit  LED        is pin_a0       -- LED to see proper PIC startup
pin_a0_direction    = output         

var  bit  LCD_RS        is pin_b5       -- LCD command/data select.
var  bit  LCD_EN        is pin_b4       -- LCD data trigger
var byte  lcd_data_port is portb_low    -- LCD data

portb_direction     = all_output    -- LCD data is portb_low


include lcd_hd44780_4               -- LCD library with 4 data lines
include print                       -- output library

for 4 loop
    LED = on
    delay_100ms(3)
    LED = off
    delay_100ms(3)
end loop

const byte str1[] = "Hello world"   -- define a string
print_string(hd44780, str1)             -- output string to LCD

const byte str2[] = "line 2"        -- define a string
const byte str3[] = "line 3"        -- define a string


hd44780_line2() 
print_string(hd44780, str2)
hd44780_line3() 
print_string(hd44780, str3)


var byte counter = 0

forever loop                        -- loop forever

    hd44780_line1() 				-- second line
    print_byte_hex(hd44780, counter)    -- output in hex format
    counter = counter + 1			-- if LCD not cleared, those lines will stay the same
    delay_100ms(2)

end loop






